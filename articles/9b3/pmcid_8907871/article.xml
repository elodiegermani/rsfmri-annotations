<?xml version='1.0' encoding='UTF-8'?>
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" dtd-version="1.3">
  <?properties open_access?>
  <processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
    <restricted-by>pmc</restricted-by>
  </processing-meta>
  <front>
    <journal-meta>
      <journal-id journal-id-type="nlm-ta">Med Image Anal</journal-id>
      <journal-id journal-id-type="iso-abbrev">Med Image Anal</journal-id>
      <journal-title-group>
        <journal-title>Medical Image Analysis</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1361-8415</issn>
      <issn pub-type="epub">1361-8423</issn>
      <publisher>
        <publisher-name>Elsevier</publisher-name>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="pmid">35131700</article-id>
      <article-id pub-id-type="pmc">8907871</article-id>
      <article-id pub-id-type="pii">S1361-8415(22)00019-6</article-id>
      <article-id pub-id-type="doi">10.1016/j.media.2022.102366</article-id>
      <article-id pub-id-type="publisher-id">102366</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Article</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Multi-dynamic modelling reveals strongly time-varying resting fMRI correlations</article-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" id="au0001">
          <name>
            <surname>Pervaiz</surname>
            <given-names>Usama</given-names>
          </name>
          <email>usama.pervaiz@ndcn.ox.ac.uk</email>
          <email>12beeupervaiz@seecs.edu.pk</email>
          <xref rid="cor0001" ref-type="corresp">⁎</xref>
          <xref rid="aff0001" ref-type="aff">a</xref>
        </contrib>
        <contrib contrib-type="author" id="au0002">
          <name>
            <surname>Vidaurre</surname>
            <given-names>Diego</given-names>
          </name>
          <xref rid="aff0002" ref-type="aff">b</xref>
          <xref rid="aff0003" ref-type="aff">c</xref>
        </contrib>
        <contrib contrib-type="author" id="au0003">
          <name>
            <surname>Gohil</surname>
            <given-names>Chetan</given-names>
          </name>
          <xref rid="aff0002" ref-type="aff">b</xref>
        </contrib>
        <contrib contrib-type="author" id="au0004">
          <name>
            <surname>Smith</surname>
            <given-names>Stephen M.</given-names>
          </name>
          <xref rid="aff0001" ref-type="aff">a</xref>
        </contrib>
        <contrib contrib-type="author" id="au0005">
          <name>
            <surname>Woolrich</surname>
            <given-names>Mark W.</given-names>
          </name>
          <xref rid="aff0002" ref-type="aff">b</xref>
        </contrib>
        <aff id="aff0001"><label>a</label>Oxford Centre for Functional MRI of the Brain (FMRIB), Wellcome Centre for Integrative Neuroimaging, Nuffield Department of Clinical Neurosciences, University of Oxford, Oxford OX3 9DU, United Kingdom</aff>
        <aff id="aff0002"><label>b</label>Oxford Centre for Human Brain Activity (OHBA), Wellcome Centre for Integrative Neuroimaging, Department of Psychiatry, University of Oxford, Oxford, OX3 7JX, United Kingdom</aff>
        <aff id="aff0003"><label>c</label>Department of Clinical Medicine, Aarhus University, Denmark</aff>
      </contrib-group>
      <author-notes>
        <corresp id="cor0001"><label>⁎</label>Corresponding author. <email>usama.pervaiz@ndcn.ox.ac.uk</email><email>12beeupervaiz@seecs.edu.pk</email></corresp>
      </author-notes>
      <pub-date pub-type="pmc-release">
        <day>1</day>
        <month>4</month>
        <year>2022</year>
      </pub-date>
      <!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="ppub">.-->
      <pub-date pub-type="ppub">
        <month>4</month>
        <year>2022</year>
      </pub-date>
      <volume>77</volume>
      <elocation-id>102366</elocation-id>
      <history>
        <date date-type="received">
          <day>23</day>
          <month>6</month>
          <year>2021</year>
        </date>
        <date date-type="rev-recd">
          <day>29</day>
          <month>10</month>
          <year>2021</year>
        </date>
        <date date-type="accepted">
          <day>10</day>
          <month>1</month>
          <year>2022</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>© 2022 The Authors. Published by Elsevier B.V.</copyright-statement>
        <copyright-year>2022</copyright-year>
        <copyright-holder/>
        <license>
          <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
          <license-p>This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).</license-p>
        </license>
      </permissions>
      <abstract abstract-type="author-highlights" id="absh001">
        <title>Highlights</title>
        <p>
          <list list-type="simple" id="lst0002">
            <list-item id="lstitem0001">
              <label>•</label>
              <p id="p0001">MAGE is multi-dynamic in that it models temporal fluctuations in FC independently from fluctuations in the mean of the activity.</p>
            </list-item>
            <list-item id="lstitem0002">
              <label>•</label>
              <p id="p0002">MAGE reveals stronger changes in FC over time than single-dynamic approaches, such as sliding window correlations.</p>
            </list-item>
            <list-item id="lstitem0003">
              <label>•</label>
              <p id="p0003">Multi-dynamic modelling provides an explanation and a solution as to why resting fMRI FC has previously looked so stable.</p>
            </list-item>
            <list-item id="lstitem0004">
              <label>•</label>
              <p id="p0004">MAGE models fMRI data as a set of reoccurring brain states, and importantly, these states do not have to be binary and mutually exclusive (e.g., multiple states can be active at one time-point).</p>
            </list-item>
            <list-item id="lstitem0005">
              <label>•</label>
              <p id="p0005">MAGE estimated time-varying FC is a better predictor of behavioural variability in the resting-state fMRI data than established methods.</p>
            </list-item>
          </list>
        </p>
      </abstract>
      <abstract abstract-type="graphical" id="absh0002">
        <title>Graphical abstract</title>
        <fig id="fig0010" position="anchor">
          <graphic xlink:href="ga1"/>
        </fig>
      </abstract>
      <abstract id="abs0001">
        <p>The activity of functional brain networks is responsible for the emergence of time-varying cognition and behaviour. Accordingly, time-varying correlations (Functional Connectivity) in resting fMRI have been shown to be predictive of behavioural traits, and psychiatric and neurological conditions. Typically, methods that measure time varying Functional Connectivity (FC), such as sliding windows approaches, do not separately model when changes occur in the mean activity levels from when changes occur in the FC, therefore conflating these two distinct types of modulation. We show that this can bias the estimation of time-varying FC to appear more stable over time than it actually is. Here, we propose an alternative approach that models changes in the mean brain activity and in the FC as being able to occur at different times to each other. We refer to this method as the Multi-dynamic Adversarial Generator Encoder (MAGE) model, which includes a model of the network dynamics that captures long-range time dependencies, and is estimated on fMRI data using principles of Generative Adversarial Networks. We evaluated the approach across several simulation studies and resting fMRI data from the Human Connectome Project (1003 subjects), as well as from UK Biobank (13301 subjects). Importantly, we find that separating fluctuations in the mean activity levels from those in the FC reveals much stronger changes in FC over time, and is a better predictor of individual behavioural variability.</p>
      </abstract>
      <kwd-group id="keys0001">
        <title>Keywords</title>
        <kwd>Functional connectivity</kwd>
        <kwd>Time-Varying functional connectivity</kwd>
        <kwd>Dynamic functional connectivity</kwd>
        <kwd>Deep learning</kwd>
        <kwd>Adversarial learning</kwd>
        <kwd>Transient brain networks</kwd>
        <kwd>Hidden Markov model</kwd>
        <kwd>LSTM</kwd>
        <kwd>RNNs</kwd>
      </kwd-group>
    </article-meta>
  </front>
  <body>
    <sec id="sec0001">
      <label>1</label>
      <title>Introduction</title>
      <p id="p0006">Large-scale networks of brain activity can be detected as fluctuations of blood oxygenation levels in functional magnetic resonance imaging (fMRI) (<xref rid="bib0006" ref-type="bibr">Biswal, Zerrin Yetkin, Haughton, Hyde, 1995</xref>, <xref rid="bib0016" ref-type="bibr">Fox, Snyder, Vincent, Corbetta, Van Essen, Raichle, 2005</xref>). These functional networks can be detected in the presence of an experimental paradigm and in spontaneous resting-state activity (<xref rid="bib0010" ref-type="bibr">De Luca, Beckmann, De Stefano, Matthews, Smith, 2006</xref>, <xref rid="bib0062" ref-type="bibr">Tavor, Jones, Mars, Smith, Behrens, Jbabdi, 2016</xref>, <xref rid="bib0015" ref-type="bibr">Fox, Raichle, 2007</xref>). Many studies estimate FC by calculating the average correlation across an entire fMRI scanning session data (<xref rid="bib0055" ref-type="bibr">Rogers, Morgan, Newton, Gore, 2007</xref>, <xref rid="bib0050" ref-type="bibr">O’Reilly, Woolrich, Behrens, Smith, Johansen-Berg, 2012</xref>, <xref rid="bib0059" ref-type="bibr">Smith, Beckmann, Andersson, Auerbach, Bijsterbosch, Douaud, Duff, Feinberg, Griffanti, Harms, et al., 2013</xref>, <xref rid="bib0058" ref-type="bibr">Smith, 2012</xref>, <xref rid="bib0053" ref-type="bibr">Pervaiz, Vidaurre, Woolrich, Smith, 2020</xref>), and these time-averaged measures of FC have been widely associated with cognitive phenotypes and neuropsychiatric disorders in the literature (<xref rid="bib0021" ref-type="bibr">Greicius, Srivastava, Reiss, Menon, 2004</xref>, <xref rid="bib0003" ref-type="bibr">Anand, Li, Wang, Wu, Gao, Bukhari, Mathews, Kalnin, Lowe, 2005</xref>, <xref rid="bib0024" ref-type="bibr">Hahn, Stein, Windischberger, Weissenbacher, Spindelegger, Moser, Kasper, Lanzenberger, 2011</xref>, <xref rid="bib0023" ref-type="bibr">Hacker, Perlmutter, Criswell, Ances, Snyder, 2012</xref>, <xref rid="bib0044" ref-type="bibr">Lynall, Bassett, Kerwin, McKenna, Kitzbichler, Muller, Bullmore, 2010</xref>).</p>
      <p id="p0007">There is now increasing interest in studying the time-varying nature of FC in fMRI. Significant within-session fluctuations in FC during rest or task fMRI have been demonstrated in a number of studies (<xref rid="bib0043" ref-type="bibr">Lurie, Kessler, Bassett, Betzel, Breakspear, Kheilholz, Kucyi, Liégeois, Lindquist, McIntosh, et al., 2020</xref>, <xref rid="bib0069" ref-type="bibr">Vidaurre, Smith, Woolrich, 2017</xref>, <xref rid="bib0032" ref-type="bibr">Hutchison, Womelsdorf, Allen, Bandettini, Calhoun, Corbetta, Della Penna, Duyn, Glover, Gonzalez-Castillo, et al., 2013</xref>, <xref rid="bib0002" ref-type="bibr">Allen, Damaraju, Plis, Erhardt, Eichele, Calhoun, 2014</xref>, <xref rid="bib0051" ref-type="bibr">Parr, Rees, Friston, 2018</xref>) and are also well-established in electrophysiological data (<xref rid="bib0004" ref-type="bibr">Baker, Brookes, Rezek, Smith, Behrens, Smith, Woolrich, 2014</xref>, <xref rid="bib0067" ref-type="bibr">Vidaurre, Hunt, Quinn, Hunt, Brookes, Nobre, Woolrich, 2018</xref>, <xref rid="bib0011" ref-type="bibr">De Pasquale, Della Penna, Snyder, Lewis, Mantini, Marzetti, Belardinelli, Ciancetta, Pizzella, Romani, et al., 2010</xref>, <xref rid="bib0012" ref-type="bibr">De Pasquale, Della Penna, Snyder, Marzetti, Pizzella, Romani, Corbetta, 2012</xref>). Further, a number of research studies have shown the utility of time-varying FC (TVFC) in identifying many psychiatric and neurological conditions e.g., multiple sclerosis (<xref rid="bib0064" ref-type="bibr">Van Schependom, Vidaurre, Costers, Sjøgård, D’hooghe, D’haeseleer, Wens, De Tiège, Goldman, Woolrich, et al., 2019</xref>, <xref rid="bib0014" ref-type="bibr">d’Ambrosio, Valsasina, Gallo, De Stefano, Pareto, Barkhof, Ciccarelli, Enzinger, Tedeschi, Stromillo, et al., 2020</xref>, <xref rid="bib0031" ref-type="bibr">Huang, Zhou, Wu, Wang, Guo, Zhao, Wan, Li, Zeng, Gong, 2019</xref>), schizophrenia (<xref rid="bib0001" ref-type="bibr">Abrol et al., 2017</xref>), Parkinson’s (<xref rid="bib0007" ref-type="bibr">Cai et al., 2018</xref>), stroke (<xref rid="bib0009" ref-type="bibr">Chen et al., 2018</xref>), autism spectrum disorder (<xref rid="bib0022" ref-type="bibr">Guo et al., 2019</xref>), epilepsy (<xref rid="bib0035" ref-type="bibr">Klugah-Brown et al., 2019</xref>) and major depressive disorder (<xref rid="bib0070" ref-type="bibr">Zhi et al., 2018</xref>); and the dynamics of TVFC have been shown to coactivate with spontaneous replay of recently acquired information (<xref rid="bib0027" ref-type="bibr">Higgins et al., 2021</xref>). Moreover, inter-subject differences in TVFC have also been associated with a number of behavioural and cognitive traits (<xref rid="bib0039" ref-type="bibr">Liégeois, Li, Kong, Orban, Van De Ville, Ge, Sabuncu, Yeo, 2019</xref>, <xref rid="bib0069" ref-type="bibr">Vidaurre, Smith, Woolrich, 2017</xref>), with some aspects of intelligence only being explained by TVFC (<xref rid="bib0068" ref-type="bibr">Vidaurre et al., 2021</xref>).</p>
      <p id="p0008">Despite these successes in the estimation and use of TVFC, it is striking how homogeneous FC actually appears to be in fMRI data over time. Indeed, there are a number of studies reporting that there is even insufficient evidence of within-session fluctuations in FC in resting fMRI data (<xref rid="bib0036" ref-type="bibr">Laumann, Snyder, Mitra, Gordon, Gratton, Adeyemo, Gilmore, Nelson, Berg, Greene, et al., 2017</xref>, <xref rid="bib0029" ref-type="bibr">Hindriks, Adhikari, Murayama, Ganzetti, Mantini, Logothetis, Deco, 2016</xref>, <xref rid="bib0037" ref-type="bibr">Leonardi, Van De Ville, 2015</xref>). While it is possible that close to homogeneous FC in fMRI is a genuine phenomenon, it is also possible that it is instead caused by limitations in the methods used to compute TVFC.</p>
      <p id="p0009">Most previous work is based on the sliding window correlation (SWC) approach (<xref rid="bib0056" ref-type="bibr">Sakoğlu et al., 2010</xref>). There are many variants of the SWC method (<xref rid="bib0002" ref-type="bibr">Allen, Damaraju, Plis, Erhardt, Eichele, Calhoun, 2014</xref>, <xref rid="bib0041" ref-type="bibr">Lindquist, Xu, Nebel, Caffo, 2014</xref>, <xref rid="bib0040" ref-type="bibr">Liégeois, Ziegler, Phillips, Geurts, Gómez, Bahri, Yeo, Soddu, Vanhaudenhuyse, Laureys, et al., 2016</xref>, <xref rid="bib0037" ref-type="bibr">Leonardi, Van De Ville, 2015</xref>), which are typically limited by using sliding windows of a specified, fixed width. This means that they fail to adapt to the intrinsic time-point by time-point variability of the FC, resulting in changes in FC getting smeared together, thereby making FC look more homogeneous over time. Some of these limitations can be overcome by methods that adapt automatically to time periods of distinct network activity, such as those based on Hidden Markov modelling (HMM) (<xref rid="bib0065" ref-type="bibr">Vidaurre, Abeysuriya, Becker, Quinn, Alfaro-Almagro, Smith, Woolrich, 2018</xref>, <xref rid="bib0054" ref-type="bibr">Quinn, Vidaurre, Abeysuriya, Becker, Nobre, Woolrich, 2018</xref>). Even then, a surprising amount of apparent homogeneity in the FC over time persists.</p>
      <p id="p0010">SWC and the HMM have in common that the mean activity and FC estimations are coupled; that is, changes in the mean activity level are by definition accompanied by changes in the FC, when both are modelled. For example, the most common version of the HMM for fMRI characterises each state as a Gaussian distribution with both mean and covariance. Since there is no biological reason for this coupling assumption, in this work we consider the consequences of relaxing that constraint, in fact showing that this change can offer a potential explanation for the homogeneity of TVFC seen in approaches that tie the dynamics of the mean and the FC together.</p>
      <p id="p0011">Our proposed method for uncoupling the dynamics of the mean activity and FC is called the Multi-dynamic Adversarial Generator-Encoder (MAGE). This proposes a multi-dynamic modelling approach that allows the mean activity and FC to fluctuate in time independently from each other. At the same time, MAGE captures long range temporal dynamics of FC and mean activity using recurrent neural networks (in contrast to the Markovian assumption of the HMM) (<xref rid="bib0018" ref-type="bibr">Gers, Schmidhuber, Cummins, 2000</xref>, <xref rid="bib0020" ref-type="bibr">Graves, Schmidhuber, 2005</xref>). Finally, our proposed model allows multiple brain states to be simultaneously active (in contrast to the categorical “mutual exclusivity” assumption of the standard HMM). To estimate this model on fMRI data, we developed a novel adversarial generator-encoder network framework inspired by the adversarial regularization used in generative adversarial networks (GANs) (<xref rid="bib0019" ref-type="bibr">Goodfellow, Pouget-Abadie, Mirza, Xu, Warde-Farley, Ozair, Courville, Bengio</xref>, <xref rid="bib0042" ref-type="bibr">Lowd, Meek, 2005</xref>, <xref rid="bib0045" ref-type="bibr">Makhzani, Shlens, Jaitly, Goodfellow, Frey</xref>).</p>
      <p id="p0012">In this paper, we demonstrate the validity of MAGE on several simulation studies and a cognitive task dataset. We also apply the method to resting-state fMRI studies and deduce several outcomes regarding TVFC temporal dynamics, revealing more distinct patterns of FC over time than are obtained with SWC and the HMM, providing an explanation as to why resting fMRI FC has appeared so temporally stable in previous work (<xref rid="bib0036" ref-type="bibr">Laumann, Snyder, Mitra, Gordon, Gratton, Adeyemo, Gilmore, Nelson, Berg, Greene, et al., 2017</xref>, <xref rid="bib0029" ref-type="bibr">Hindriks, Adhikari, Murayama, Ganzetti, Mantini, Logothetis, Deco, 2016</xref>, <xref rid="bib0037" ref-type="bibr">Leonardi, Van De Ville, 2015</xref>). Finally, we substantiate our findings by demonstrating improved prediction of behavioural and cognitive traits using MAGE-derived TVFC estimates.</p>
    </sec>
    <sec id="sec0002">
      <label>2</label>
      <title>Methods</title>
      <sec id="sec0003">
        <label>2.1</label>
        <title><italic>multi-dynamic</italic> model</title>
        <p id="p0013">Our proposed approach assumes that fMRI data is generated by a multivariate Normal distribution process with a time-varying mean, <inline-formula><mml:math id="M1" altimg="si1.svg"><mml:msub><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, and covariance, <inline-formula><mml:math id="M2" altimg="si4.svg"><mml:msub><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>:<disp-formula id="eq0001"><label>(1)</label><mml:math id="M3" altimg="si5.svg"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M4" altimg="si6.svg"><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is the value of standardised fMRI data, Y (N x T) at time point t, and N is the number of channels (e.g., brain regions).</p>
        <p id="p0014">In order to separately model the time-varying variances and the correlations, we partition the covariance into a NxN diagonal matrix of standard deviations for each brain region, <inline-formula><mml:math id="M5" altimg="si7.svg"><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, and an NxN correlation matrix, <inline-formula><mml:math id="M6" altimg="si8.svg"><mml:msub><mml:mi>F</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>:<disp-formula id="eq0002"><label>(2)</label><mml:math id="M7" altimg="si9.svg"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>F</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula> where the correlation matrix, <inline-formula><mml:math id="M8" altimg="si8.svg"><mml:msub><mml:mi>F</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, captures instantaneous correlation between brain regions; which we refer to as instantaneous FC.</p>
        <p id="p0015">Clearly, it will not be possible to estimate the instantaneous correlation and means (and variances) at every timepoint without further constraints. As such, we model regularised versions of them by capturing their repeating spatio-temporal structure using an adaptive temporal prior.</p>
        <p id="p0016">Specifically, we assume that the means and correlations (and variances) are generated from their own linear mixture of a limited, underlying set of dynamic modes or states:<disp-formula id="eq0003"><label>(3)</label><mml:math id="M9" altimg="si10.svg"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>p</mml:mi></mml:munder><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula><disp-formula id="eq0004"><label>(4)</label><mml:math id="M10" altimg="si11.svg"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>q</mml:mi></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula><disp-formula id="eq0005"><label>(5)</label><mml:math id="M11" altimg="si12.svg"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>r</mml:mi></mml:munder><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mtext>diag</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="script">E</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M12" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a scalar corresponding to the time course of the <inline-formula><mml:math id="M13" altimg="si14.svg"><mml:mi>p</mml:mi></mml:math></inline-formula>th “mean activity” state (p=1... P), and <inline-formula><mml:math id="M14" altimg="si15.svg"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula> is its Nx1 spatial map of mean activity; and <inline-formula><mml:math id="M15" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a scalar corresponding to the time course of the <inline-formula><mml:math id="M16" altimg="si17.svg"><mml:mi>q</mml:mi></mml:math></inline-formula>th “correlation” state (q=1... Q), and <inline-formula><mml:math id="M17" altimg="si18.svg"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula> is its NxN correlation matrix; and <inline-formula><mml:math id="M18" altimg="si19.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a scalar corresponding to the time course of the <inline-formula><mml:math id="M19" altimg="si20.svg"><mml:mi>r</mml:mi></mml:math></inline-formula>th “variance” state (r=1... R), and <inline-formula><mml:math id="M20" altimg="si21.svg"><mml:msub><mml:mi mathvariant="script">E</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula> is its Nx1 spatial map of the standard deviations. The <inline-formula><mml:math id="M21" altimg="si18.svg"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula> correlation matrices capture the state-specific correlation between brain regions; which we refer to as the state-specific FC. As we shall describe in detail later, we assume that both the state time courses [<inline-formula><mml:math id="M22" altimg="si22.svg"><mml:mi>α</mml:mi></mml:math></inline-formula>, <inline-formula><mml:math id="M23" altimg="si23.svg"><mml:mi>β</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="M24" altimg="si24.svg"><mml:mi>γ</mml:mi></mml:math></inline-formula>] and the state-specific maps [<inline-formula><mml:math id="M25" altimg="si15.svg"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M26" altimg="si18.svg"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M27" altimg="si21.svg"><mml:msub><mml:mi mathvariant="script">E</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>] are unknown and need inferring from the data. Also, <inline-formula><mml:math id="M28" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M29" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M30" altimg="si19.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are not coupled together and are completely free to fluctuate independently.</p>
        <p id="p0017">Note that in <xref rid="eq0003" ref-type="disp-formula">Eqs. (3)</xref>, <xref rid="eq0004" ref-type="disp-formula">(4)</xref>, <xref rid="eq0005" ref-type="disp-formula">(5)</xref> the correlations and means (and variances) are regularised using their own distinct priors, or dynamics. This is in contrast to most TVFC methods, which are <italic>single-dynamic</italic> approaches in that the dynamics of the means and the correlations (i.e., the FC) are tied together. However, there is no imperative to assume that the dynamics of the means and correlations are the same as each other. As such, the proposed method is designed to explore what happens when we do not tie all of the dynamics together. We refer to this approach as <italic>multi-dynamic</italic>, as illustrated in <xref rid="fig0001" ref-type="fig">Fig. 1</xref>[A].<fig id="fig0001"><label>Fig. 1</label><caption><p>Single-dynamic versus multi-dynamic brain networks. <bold>[A]</bold> Top plot shows example brain network dynamics for the two scenarios; line width indicates functional connectivity (FC) strength, and size of node indicates mean activity amplitude. Middle and bottom plots highlight how the single-dynamic case assumes that the means and the FC change together, whereas in the multi-dynamic case they can change at distinct times. <bold>[B]</bold> Simple simulation illustrating the potential benefits of a multi-dynamic approach. The ground truth is that there are different dynamics underlying the time-varying means and FC. The multi-dynamic approach is able to accurately adjust to fluctuating FC (illustrated for four edges of the FC matrix), whereas the single-dynamic approach is not able to accurately capture these fluctuations, producing time-varying, instantaneous FC that erroneously looks much more homogeneous, as is often observed in time-varying FC estimates in real fMRI data. Lastly, the multi-dynamic approach is also able to adjust to fluctuating mean as shown in Figure S6.</p></caption><alt-text id="at0001">Fig. 1</alt-text><graphic xlink:href="gr1"/></fig></p>
        <sec id="sec0004">
          <label>2.1.1</label>
          <title>Special case - Sliding window correlation</title>
          <p id="p0018">Sliding window correlation (SWC) measures of TVFC capture how the between-brain-region correlation fluctuates over time. For simplicity here (but without loss of generality), we assume non-overlapping sliding windows. This corresponds to <xref rid="eq0003" ref-type="disp-formula">(3)</xref>, <xref rid="eq0004" ref-type="disp-formula">(4)</xref>, <xref rid="eq0005" ref-type="disp-formula">(5)</xref>, where <inline-formula><mml:math id="M31" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M32" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M33" altimg="si19.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are set to be the same, and are fixed a priori to correspond to the P=Q=R different positions the sliding window can take as it slides through time (e.g., in the case of square windows, <inline-formula><mml:math id="M34" altimg="si22.svg"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="M35" altimg="si23.svg"><mml:mi>β</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="M36" altimg="si24.svg"><mml:mi>γ</mml:mi></mml:math></inline-formula> have a value of one inside the sliding window, and a value of zero outside of it). Note that P=Q=R needs to typically be very large to span all the data over time; and so SWC approaches are normally followed by a clustering approach, such as k-means, to find repeating correlation patterns (<xref rid="bib0002" ref-type="bibr">Allen, Damaraju, Plis, Erhardt, Eichele, Calhoun, 2014</xref>, <xref rid="bib0061" ref-type="bibr">Tagliazucchi, Von Wegner, Morzelewski, Brodbeck, Laufs, 2012</xref>). Typically, information about how the mean fluctuates over time is ignored. Since <inline-formula><mml:math id="M37" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M38" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M39" altimg="si19.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are set to be the same, i.e., the means and correlations (and variances) are modelled using the same dynamics, then SWC corresponds to what we refer to as a <italic>single-dynamics</italic> approach (see <xref rid="fig0001" ref-type="fig">Fig. 1</xref>[A]).</p>
        </sec>
        <sec id="sec0005">
          <label>2.1.2</label>
          <title>Special case - hidden Markov models</title>
          <p id="p0019">Hidden Markov Models (HMM), with multi-variate Normal observation models, capture how both the mean activity levels and the between-brain-region correlations fluctuate over time. This form of the HMM is the same as SWC in that it corresponds to <xref rid="eq0003" ref-type="disp-formula">(3)</xref>, <xref rid="eq0004" ref-type="disp-formula">(4)</xref>, <xref rid="eq0005" ref-type="disp-formula">(5)</xref> where the time courses <inline-formula><mml:math id="M40" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M41" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M42" altimg="si19.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the same however, <inline-formula><mml:math id="M43" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M44" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M45" altimg="si19.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are now inferred from the data at the same time as <inline-formula><mml:math id="M46" altimg="si15.svg"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M47" altimg="si18.svg"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M48" altimg="si21.svg"><mml:msub><mml:mi mathvariant="script">E</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>. This means that the approach can adjust to how the transient network states are coming and going for different durations at different points in time. Note that in addition, the HMM assumes that <inline-formula><mml:math id="M49" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = <inline-formula><mml:math id="M50" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = <inline-formula><mml:math id="M51" altimg="si19.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are binary time courses, defining when states p switches on and off, and that no two states can be active at the same time (i.e., the states are mutually exclusive). As with SWC, since the means and correlations (and variances) are modelled using the same dynamics, then this version of the HMM corresponds to what we refer to as a <italic>single-dynamics</italic> approach (see <xref rid="fig0001" ref-type="fig">Fig. 1</xref>[A]).</p>
        </sec>
      </sec>
      <sec id="sec0006">
        <label>2.2</label>
        <title>What do we mean by functional connectivity?</title>
        <p id="p0020">Typically, correlation-based functional connectivity in fMRI refers to the correlation between two fMRI time series. However, in the model we are proposing, there are multiple entities that could be described as FC, all of which capture some different aspect of correlation between brain regions. First, the model describes the correlation at each time point, i.e., <inline-formula><mml:math id="M52" altimg="si8.svg"><mml:msub><mml:mi>F</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> (Eqs. <xref rid="eq0001" ref-type="disp-formula">(1)</xref>, <xref rid="eq0002" ref-type="disp-formula">(2)</xref>). We refer to these as the <bold>instantaneous FCs</bold>. Second, a set of state-specific correlations, i.e., <inline-formula><mml:math id="M53" altimg="si25.svg"><mml:msub><mml:mi>D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula>, are mixed together to regularise the instantaneous FC (see <xref rid="eq0004" ref-type="disp-formula">Eq. (4)</xref>). We will refer to these as <bold>state-specific FCs</bold>. Finally, we might also consider correlations in the mean activity time courses, which is a single correlation matrix that corresponds to the correlation of <inline-formula><mml:math id="M54" altimg="si1.svg"><mml:msub><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> over all time, i.e., Corr(<inline-formula><mml:math id="M55" altimg="si1.svg"><mml:msub><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>). We will refer to this as the <bold>mean activity FC</bold>; this is potentially quite independent of the state-specific FCs.</p>
        <p id="p0021">Our model provides a regularised estimate of the instantaneous FC, and so we can more parsimoniously represent the instantaneous FC using the state-specific FCs. Hence in this work, we focus on using the state-specific FCs as our main TVFC feature of interest, for example when predicting behavioural traits.</p>
      </sec>
      <sec id="sec0007">
        <label>2.3</label>
        <title>Multi-dynamic adversarial generator-encoder (MAGE)</title>
        <p id="p0022">Equations <xref rid="eq0001" ref-type="disp-formula">(1)</xref>–<xref rid="eq0005" ref-type="disp-formula">(5)</xref> describe the modelling framework for the multi-dynamic approach we are proposing. In this section, we will describe the more complete generative model, including the generative process assumed for the dynamics of <inline-formula><mml:math id="M56" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M57" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M58" altimg="si19.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, and how we infer on the model. We refer to the overall approach as the <italic>Multi-dynamic Adversarial Generator-Encoder</italic> (MAGE).</p>
        <p id="p0023">In practice, MAGE assumes that the dynamics of the means and variances are tied together, but crucially the correlation is assumed to fluctuate independently. This corresponds to <xref rid="eq0003" ref-type="disp-formula">Eqs. (3)</xref>, <xref rid="eq0004" ref-type="disp-formula">(4)</xref>, <xref rid="eq0005" ref-type="disp-formula">(5)</xref> with <inline-formula><mml:math id="M59" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = <inline-formula><mml:math id="M60" altimg="si19.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (P=R), but with <inline-formula><mml:math id="M61" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> free to be inferred separately.<xref rid="fn0001" ref-type="fn">1</xref> Alongside the state time courses we also infer the state-specific features: <inline-formula><mml:math id="M62" altimg="si15.svg"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M63" altimg="si18.svg"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M64" altimg="si21.svg"><mml:msub><mml:mi mathvariant="script">E</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>. Note that while the dynamics of both the means and the variances are always modelled (and are tied together with the same dynamics), for simplicity we will tend to refer to just the dynamics of the means throughout the paper.</p>
        <p id="p0024">In addition, unlike the HMM, MAGE does not assume that state time courses are binary and mutually exclusive. Instead, we assume that they describe time-varying linear mixtures with a sum-to-one constraint (<inline-formula><mml:math id="M65" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M66" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M67" altimg="si19.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> separately sums to one at each time point), which we will refer to as “partial volume” state time-courses. This sum-to-one constraint is an identification condition that is imposed to ensure identifiability (<xref rid="bib0030" ref-type="bibr">Huang, 2014</xref>) on the inferred states and makes the post-model temporal analysis interpretable.</p>
        <p id="p0025">In summary, MAGE describes the data as being generated from a finite set of states. These states are linearly mixed together at each time-point to generate a time-varying description of the data’s mean and covariance.</p>
        <sec id="sec0008">
          <label>2.3.1</label>
          <title>Generative model</title>
          <p id="p0026">The generative model for the data, <inline-formula><mml:math id="M68" altimg="si6.svg"><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, corresponds to <xref rid="eq0001" ref-type="disp-formula">Eq. (1)</xref>. Each instance of <inline-formula><mml:math id="M69" altimg="si6.svg"><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is described by a multivariate Normal distribution parameterised by the mean activity at time t, <inline-formula><mml:math id="M70" altimg="si1.svg"><mml:msub><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, (<xref rid="eq0003" ref-type="disp-formula">Eq. (3)</xref>) and the covariance matrix at time t, <inline-formula><mml:math id="M71" altimg="si4.svg"><mml:msub><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> (<xref rid="eq0002" ref-type="disp-formula">Eq. (2)</xref>). We model the state time courses, <inline-formula><mml:math id="M72" altimg="si26.svg"><mml:msub><mml:mi>α</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M73" altimg="si27.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M74" altimg="si28.svg"><mml:msub><mml:mi>β</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, based on their underlying logits:<disp-formula id="eq0006"><label>(6)</label><mml:math id="M75" altimg="si29.svg"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>ζ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="eq0007"><label>(7)</label><mml:math id="M76" altimg="si30.svg"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>ζ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M77" altimg="si31.svg"><mml:mi>ζ</mml:mi></mml:math></inline-formula> is the softmax function, ensuring that <inline-formula><mml:math id="M78" altimg="si22.svg"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="M79" altimg="si23.svg"><mml:mi>β</mml:mi></mml:math></inline-formula> sum to one (over states) at each time point.</p>
          <p id="p0027">The dynamics in <inline-formula><mml:math id="M80" altimg="si32.svg"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M81" altimg="si33.svg"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> (and implicitly the dynamics of the state time courses) are captured using a unidirectional sequence-to-sequence long short-term memory (LSTM) model, which uses the history of <inline-formula><mml:math id="M82" altimg="si34.svg"><mml:mi>θ</mml:mi></mml:math></inline-formula>, to predict the value at the next time point. Specifically, it predicts the prior means of the latent, time-varying parameters [<inline-formula><mml:math id="M83" altimg="si32.svg"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M84" altimg="si33.svg"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>].<disp-formula id="eq0008"><label>(8)</label><mml:math id="M85" altimg="si35.svg"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="eq0009"><label>(9)</label><mml:math id="M86" altimg="si36.svg"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mrow><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M87" altimg="si37.svg"><mml:msubsup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M88" altimg="si38.svg"><mml:msubsup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> are the prior means of <inline-formula><mml:math id="M89" altimg="si32.svg"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M90" altimg="si33.svg"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> respectively. <inline-formula><mml:math id="M91" altimg="si39.svg"><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is the affine transformation and <inline-formula><mml:math id="M92" altimg="si40.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M93" altimg="si41.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> represents the weights of the affine transformation. <inline-formula><mml:math id="M94" altimg="si42.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M95" altimg="si43.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> are the generative model LSTM weights. The proposed generative model for the data is illustrated in <xref rid="fig0002" ref-type="fig">Fig. 2</xref> (and the in-depth architecture is illustrated in Figure S2).<fig id="fig0002"><label>Fig. 2</label><caption><p>Generative model for MAGE. The proposed model generates data by first generating instantaneous means and the instantaneous correlation matrices (i.e., functional connectivity). MAGE also models instantaneous variances, whose dynamics are tied to be the same as the mean (not shown here). The instantaneous mean is modelled using an underlying set of states, for which the state time courses are generated using a long short-term memory (LSTM) model. The instantaneous correlation is also modelled using an underlying set of states, whose state time courses are generated using a completely different LSTM, making the approach multi-dynamic. The generative model for SAGE is illustrated in Figure S1.</p></caption><alt-text id="at0002">Fig. 2</alt-text><graphic xlink:href="gr2"/></fig></p>
        </sec>
        <sec id="sec0009">
          <label>2.3.2</label>
          <title>Inference</title>
          <p id="p0028">Given fMRI data, we need to infer on the parameters [<inline-formula><mml:math id="M96" altimg="si15.svg"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M97" altimg="si18.svg"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M98" altimg="si21.svg"><mml:msub><mml:mi mathvariant="script">E</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M99" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M100" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M101" altimg="si42.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M102" altimg="si43.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M103" altimg="si40.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M104" altimg="si41.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>] in the generative model. We infer point estimates with uniform priors for the global parameters in the model, i.e., [<inline-formula><mml:math id="M105" altimg="si15.svg"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M106" altimg="si18.svg"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M107" altimg="si21.svg"><mml:msub><mml:mi mathvariant="script">E</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M108" altimg="si42.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M109" altimg="si43.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M110" altimg="si40.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M111" altimg="si41.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>]; but for the more challenging inference of the latent, time-varying parameters [<inline-formula><mml:math id="M112" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M113" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>], we want to regularise using priors (which here corresponds to the prior means of [<inline-formula><mml:math id="M114" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M115" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>] as stated in Eqs. <xref rid="eq0008" ref-type="disp-formula">(8)</xref>, <xref rid="eq0009" ref-type="disp-formula">(9)</xref>). This could be attempted using a number of different approaches. For example, Variational Bayes (VB) methods could be used based on the ideas from Variational autoencoders (VAEs) (<xref rid="bib0034" ref-type="bibr">Kingma and Welling, 2013</xref>), where the generative model acts as a decoder that maps from the latent, time-varying parameters [<inline-formula><mml:math id="M116" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M117" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>] to the fMRI data. The loss function in VB inference is based on optimizing the variational free energy (<xref rid="bib0017" ref-type="bibr">Friston et al., 2007</xref>) and consists of two terms - the reconstruction likelihood, and the Kullback-Leibler (KL) divergence that regularises the solution by matching the learned posterior distribution to a prior distribution over the latent variables (i.e., Eqs. <xref rid="eq0008" ref-type="disp-formula">(8)</xref>, <xref rid="eq0009" ref-type="disp-formula">(9)</xref>).</p>
          <p id="p0029">Here, we take an approach based on an adversarial autoencoder (AAE) (<xref rid="bib0045" ref-type="bibr">Makhzani et al., 2015</xref>). Again, the generative model acts as a decoder that maps from the parameters underlying the state time courses, [<inline-formula><mml:math id="M118" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M119" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>], to the fMRI data, and hence the reconstruction likelihood term of the AAE is the same as it would be in a VAE. However, the AAE replaces the regularising KL divergence term of the VAE with an adversarial training criterion (<xref rid="bib0045" ref-type="bibr">Makhzani, Shlens, Jaitly, Goodfellow, Frey</xref>, <xref rid="bib0047" ref-type="bibr">Mescheder, Nowozin, Geiger, 2017</xref>). This takes the idea of adversarial loss from GANs to achieve the prior regularization - by forcing the posterior means underlying the state time courses, [<inline-formula><mml:math id="M120" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M121" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>], to be close to the specified prior means (i.e., Eqs. <xref rid="eq0008" ref-type="disp-formula">(8)</xref>, <xref rid="eq0009" ref-type="disp-formula">(9)</xref>). To do this, we train a discriminator, separately from the training that corresponds to the generative model parameter inference, to be able to distinguish between the prior and posterior versions of the [<inline-formula><mml:math id="M122" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M123" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>]. The trained discriminator is then used to enforce closeness between the posterior and prior (alongside the reconstruction likelihood) when performing the model parameter inference.</p>
          <p id="p0030"><italic>Encoder Model</italic> The encoder model maps from the fMRI data to the posterior estimates of the latent, time-varying parameters [<inline-formula><mml:math id="M124" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M125" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>]. This can also be referred to as the inference network or inference model and corresponds to the idea of amortized inference in VAEs, whereby the encoder allows an efficient means to “look-up” the posterior estimates given the data (<xref rid="bib0034" ref-type="bibr">Kingma and Welling, 2013</xref>). The authors who proposed AAEs (<xref rid="bib0045" ref-type="bibr">Makhzani et al., 2015</xref>) explored the benefits of being fully Bayesian on the latent variables, by assuming that the posterior is a Gaussian distribution (with the mean and variance predicted by the encoder, in a similar manner to the VAE); but after an extensive hyper-parameter search, they did not find any additional advantages, and only reported results using a deterministic version of the posterior. As such, we learned a single nonlinear mapping that is used to map from the data, <inline-formula><mml:math id="M126" altimg="si6.svg"><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, to the posterior means at any time point:<disp-formula id="eq0010"><label>(10)</label><mml:math id="M127" altimg="si46.svg"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="eq0011"><label>(11)</label><mml:math id="M128" altimg="si47.svg"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M129" altimg="si48.svg"><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M130" altimg="si49.svg"><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> are the posterior means of <inline-formula><mml:math id="M131" altimg="si32.svg"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M132" altimg="si33.svg"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> respectively. <inline-formula><mml:math id="M133" altimg="si50.svg"><mml:mrow><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a sequence-to-sequence, bidirectional LSTM model, and <inline-formula><mml:math id="M134" altimg="si51.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M135" altimg="si52.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> are the encoder LSTM weights. <inline-formula><mml:math id="M136" altimg="si39.svg"><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is the affine transformation and <inline-formula><mml:math id="M137" altimg="si53.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M138" altimg="si54.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> represents the weights of the affine transformation. Note that the approach is still stochastic since we use batching of the data.</p>
          <p id="p0031"><italic>Discriminator Model</italic> As mentioned above, a discriminator is needed to be able to distinguish between the prior and posterior mean estimates of the state time courses, [<inline-formula><mml:math id="M139" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M140" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>]. The discriminator is also constructed using a sequence-to-sequence, bidirectional LSTM model and it classifies whether samples are from the posterior or prior estimates of [<inline-formula><mml:math id="M141" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M142" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>]:<disp-formula id="eq0012"><label>(12)</label><mml:math id="M143" altimg="si55.svg"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mi>ζ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>ζ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="eq0013"><label>(13)</label><mml:math id="M144" altimg="si56.svg"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>σ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mi>ζ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>ζ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M145" altimg="si57.svg"><mml:mi>σ</mml:mi></mml:math></inline-formula> is the sigmoid activation to ensure that discriminator output is either 0 or 1, and <inline-formula><mml:math id="M146" altimg="si58.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M147" altimg="si59.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> are the discriminator LSTM weights. <inline-formula><mml:math id="M148" altimg="si39.svg"><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> is the affine transformation and <inline-formula><mml:math id="M149" altimg="si60.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M150" altimg="si61.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula> represents the weights of the affine transformation. Note that the discriminator takes in as input the full history of both the prior and posterior mean state time courses into its LSTM. Taken together with the fact that we do not factorise the posteriors of [<inline-formula><mml:math id="M151" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M152" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>] over time, this means that the trained discriminator will help drive the prior and posterior state time courses to have similar characteristics not just over short, but also over long, time scales.</p>
        </sec>
        <sec id="sec0010">
          <label>2.3.3</label>
          <title>How it works</title>
          <p id="p0032">We trained this model as a three-player game played between the generator (i.e., the generative model with parameters [<inline-formula><mml:math id="M153" altimg="si15.svg"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M154" altimg="si18.svg"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M155" altimg="si21.svg"><mml:msub><mml:mi mathvariant="script">E</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M156" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M157" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M158" altimg="si42.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M159" altimg="si43.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M160" altimg="si40.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M161" altimg="si41.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>]), encoder (with parameters [<inline-formula><mml:math id="M162" altimg="si51.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M163" altimg="si52.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M164" altimg="si53.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M165" altimg="si54.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>]), and discriminator (with parameters [<inline-formula><mml:math id="M166" altimg="si58.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M167" altimg="si59.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M168" altimg="si60.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M169" altimg="si61.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>]). The discriminator model is trained to distinguish prior mean estimates of [<inline-formula><mml:math id="M170" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M171" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>] from their posterior mean estimates. The discriminator is then used to enforce closeness between the posterior and prior of those parameters (while also honouring the reconstruction likelihood) when training the encoder and generator. In this game, when the discriminator successfully identifies the prior from posterior, it is rewarded; whereas both encoder and generator models are penalized. In contrast, when the combined efforts of the encoder and generator models fools the discriminator, the discriminator is penalized. Note, that at the same time the encoder and generator models must also look to maximise the reconstruction likelihood.</p>
          <p id="p0033">This three-player game is played with two main loss functions that are listed below:<list list-type="simple" id="lst0001"><list-item id="lstitem0006"><label>1.</label><p id="p0034"><bold>Reconstruction (Likelihood) loss:</bold> The first loss corresponds to the likelihood - this tells us how well we are explaining our data according to the current estimate of the generative model, and is given by:<disp-formula id="eq0014"><label>(14)</label><mml:math id="M172" altimg="si62.svg"><mml:mrow><mml:mi>L</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mspace width="0.16em"/><mml:mi>log</mml:mi><mml:mspace width="0.16em"/><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo linebreak="badbreak">=</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msubsup><mml:mo linebreak="badbreak">=</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p></list-item><list-item id="lstitem0007"><label>2.</label><p id="p0035"><bold>Regularization (Prior) Loss:</bold> The second loss regularises the estimate of the latent, time-varying parameters [<inline-formula><mml:math id="M173" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M174" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>] using an adaptive prior - this penalises when the posterior estimates of [<inline-formula><mml:math id="M175" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M176" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>] deviate from the prior:<disp-formula id="eq0015"><label>(15)</label><mml:math id="M177" altimg="si63.svg"><mml:mrow><mml:mi>R</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:mo>[</mml:mo><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>E</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.16em"/><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo>∥</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mi>E</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>y</mml:mi><mml:mspace width="0.16em"/><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo>∥</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>t</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p id="p0036">This corresponds to the cross-entropy between the prior and the posterior of the latent, time-varying parameters [<inline-formula><mml:math id="M178" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M179" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>].</p></list-item></list></p>
          <p id="p0037">The total loss is the summation of these two terms:<disp-formula id="eq0016"><label>(16)</label><mml:math id="M180" altimg="si64.svg"><mml:mrow><mml:mi>F</mml:mi><mml:mo linebreak="goodbreak">=</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>Λ</mml:mi></mml:mstyle><mml:mi>L</mml:mi><mml:mo linebreak="goodbreak">+</mml:mo><mml:mfrac><mml:mstyle scriptlevel="0" displaystyle="false"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>Λ</mml:mi></mml:mstyle></mml:mrow></mml:mstyle><mml:mstyle scriptlevel="0" displaystyle="false"><mml:mn>2</mml:mn></mml:mstyle></mml:mfrac><mml:mi>R</mml:mi></mml:mrow></mml:math></disp-formula> where we attribute a certain weight to each term using <inline-formula><mml:math id="M181" altimg="si65.svg"><mml:mstyle mathvariant="normal"><mml:mi>Λ</mml:mi></mml:mstyle></mml:math></inline-formula>. The expression in <xref rid="eq0016" ref-type="disp-formula">Eq. (16)</xref> can be thought of as an approximation of the variational free energy, but where the KL term is replaced by regularisation loss in <xref rid="eq0015" ref-type="disp-formula">Eq. (15)</xref>. The complete derivation for the regularisation loss in <xref rid="eq0015" ref-type="disp-formula">Eq. (15)</xref> is given in Section S1.5. We trained the parameters (i.e., <inline-formula><mml:math id="M182" altimg="si15.svg"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M183" altimg="si18.svg"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M184" altimg="si21.svg"><mml:msub><mml:mi mathvariant="script">E</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M185" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M186" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M187" altimg="si42.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M188" altimg="si43.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M189" altimg="si51.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M190" altimg="si52.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M191" altimg="si58.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M192" altimg="si59.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M193" altimg="si40.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M194" altimg="si41.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M195" altimg="si53.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M196" altimg="si54.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M197" altimg="si60.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M198" altimg="si61.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>) using these losses in two phases - the reconstruction phase and the regularization phase - which are explained below:<list list-type="simple" id="lst0003"><list-item id="lstitem0008"><label>•</label><p id="p0038"><bold>Reconstruction Phase:</bold> In the reconstruction phase (<xref rid="eq0014" ref-type="disp-formula">Eq. (14)</xref>), the generator model (with parameters [<inline-formula><mml:math id="M199" altimg="si15.svg"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M200" altimg="si18.svg"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M201" altimg="si21.svg"><mml:msub><mml:mi mathvariant="script">E</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M202" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M203" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M204" altimg="si42.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M205" altimg="si43.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M206" altimg="si40.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M207" altimg="si41.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>g</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>]) and encoder model (with parameters [<inline-formula><mml:math id="M208" altimg="si51.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M209" altimg="si52.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M210" altimg="si53.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M211" altimg="si54.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>]) are updated to minimize the reconstruction loss. We kept the discriminator model (with parameters [<inline-formula><mml:math id="M212" altimg="si58.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M213" altimg="si59.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M214" altimg="si60.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M215" altimg="si61.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>]) constant during this phase, otherwise the generator and encoder would be trying to hit a moving target and might never converge.</p></list-item><list-item id="lstitem0009"><label>•</label><p id="p0039"><bold>Regularization Phase:</bold> In the regularization phase (<xref rid="eq0015" ref-type="disp-formula">Eq. (15)</xref>), the discriminator model (with parameters [<inline-formula><mml:math id="M216" altimg="si58.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M217" altimg="si59.svg"><mml:msubsup><mml:mi>ω</mml:mi><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M218" altimg="si60.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:math></inline-formula>, <inline-formula><mml:math id="M219" altimg="si61.svg"><mml:msubsup><mml:mi>λ</mml:mi><mml:mi>d</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math></inline-formula>]) is first updated to distinguish prior and posterior mean estimates of [<inline-formula><mml:math id="M220" altimg="si44.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="M221" altimg="si45.svg"><mml:msup><mml:mi>θ</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:math></inline-formula>]. Then, the parameters of the generator model and encoder model are updated to confuse the discriminator model.</p></list-item></list></p>
        </sec>
        <sec id="sec0011">
          <label>2.3.4</label>
          <title>Single-dynamic adversarial generator-Encoder (SAGE)</title>
          <p id="p0040">There is variant of the proposed model, SAGE, that assumes the time courses <inline-formula><mml:math id="M222" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M223" altimg="si19.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M224" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the same. In this regard it is the same as the HMM. However, SAGE maintains the long-range temporal modelling and the partial volume modelling of the network state dynamics that are not part of the standard HMM. Throughout this paper, we will compare MAGE with SAGE to highlight the benefits of the multi-dynamic modelling. SAGE is explained in Section S1.1 and is illustrated in Figure S1.</p>
        </sec>
      </sec>
      <sec id="sec0012">
        <label>2.4</label>
        <title>Dual-Estimation of the group-level MAGE</title>
        <p id="p0041">We performed a process of dual-estimation (analogous to dual-regression following group-ICA) (<xref rid="bib0005" ref-type="bibr">Beckmann et al., 2009</xref>) to infer the subject-level state versions of the group-level MAGE. This allows us to obtain a subject-specific description of time-varying coorelation and time-varying mean. To achieve this, we used the trained parameters inferred from the group-level MAGE (<inline-formula><mml:math id="M225" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M226" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M227" altimg="si15.svg"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M228" altimg="si18.svg"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M229" altimg="si21.svg"><mml:msub><mml:mi mathvariant="script">E</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>). Then we re-estimated the <inline-formula><mml:math id="M230" altimg="si4.svg"><mml:msub><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M231" altimg="si1.svg"><mml:msub><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> for each subject by holding constant the <inline-formula><mml:math id="M232" altimg="si22.svg"><mml:mi>α</mml:mi></mml:math></inline-formula> and <inline-formula><mml:math id="M233" altimg="si23.svg"><mml:mi>β</mml:mi></mml:math></inline-formula> parameters, and only retraining <inline-formula><mml:math id="M234" altimg="si15.svg"><mml:msub><mml:mi mathvariant="script">S</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M235" altimg="si18.svg"><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M236" altimg="si21.svg"><mml:msub><mml:mi mathvariant="script">E</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:math></inline-formula>.</p>
      </sec>
      <sec id="sec0013">
        <label>2.5</label>
        <title>Hyper-parameters tuning and cross-validation</title>
        <p id="p0042">The hyper-parameters for MAGE were chosen using extensive trial and error by monitoring the validation loss. Some of the hyper-parameters are detailed as follows: 1) The sequence/window length, W, (number of data time-points) was set to 100 and batch-size, B, (number of grouped sequences) was set to 32 - this implies that each batch has a dimension of B*W*N. 2) a small learning rate of 0.0001 was used with large momentum value of 0.9. 3) Nesterov-accelerated Adaptive Moment Estimation (NAdam) optimizer was applied for training the data. 4) the number of units (the dimension of the inner cells in LSTM) for each LSTM layer was set between 8 to 64 (depending on the number of subjects). 5) <inline-formula><mml:math id="M237" altimg="si65.svg"><mml:mstyle mathvariant="normal"><mml:mi>Λ</mml:mi></mml:mstyle></mml:math></inline-formula> was optimised depending on the data-set (mostly constrained between 0.85 to 0.95 <xref rid="bib0028" ref-type="bibr">Higgins et al. (2016)</xref>). MAGE is an unsupervised algorithm, still, we were rigorous with the performance validation - we trained MAGE using the training/validation split with 80% data in the training subset and 20% data in the validation subset during any experiment.</p>
        <p id="p0043">To ensure that the reported MAGE results are reproducible, we performed cross-validations on different non-overlapping sets of subjects. We calculated the similarity of the MAGE estimated state-specific FC correlation and mean activity estimates across these different runs to highlight that the MAGE estimated states are replicable. For statistical testing conducted in this paper, we have performed paired <italic>t</italic>-test to determine whether there is statistical evidence that the mean difference between paired observations on a particular outcome is significantly different from zero. We have used symbols to report the test results; * when <inline-formula><mml:math id="M238" altimg="si66.svg"><mml:mrow><mml:mi>P</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></inline-formula>, ** when <inline-formula><mml:math id="M239" altimg="si67.svg"><mml:mrow><mml:mi>P</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math></inline-formula> and *** when <inline-formula><mml:math id="M240" altimg="si68.svg"><mml:mrow><mml:mi>P</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
    </sec>
    <sec id="sec0014">
      <label>3</label>
      <title>Results</title>
      <sec id="sec0015">
        <label>3.1</label>
        <title>MAGE can infer dynamic linear mixtures of FC states</title>
        <p id="p0044">We start by considering the performance of our proposed method, MAGE, when we set aside the proposed multi-dynamic modelling. This version of MAGE models single-dynamics (where the state time courses for the mean activity and the correlations are the same, i.e., <inline-formula><mml:math id="M241" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = <inline-formula><mml:math id="M242" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and is referred to as SAGE. SAGE otherwise maintains all of the other features of MAGE, including the long-range temporal modelling and the partial volume modelling of the state dynamics.</p>
        <p id="p0045">We first demonstrate SAGE’s ability to infer state time courses that are dynamic linear mixtures (i.e., partial volume mixtures) with more than one underlying state active at each time point, t. Note that this is in contrast to categorical simulations (i.e., HMM assumptions), where the ground-truth state time-courses, <inline-formula><mml:math id="M243" altimg="si22.svg"><mml:mi>α</mml:mi></mml:math></inline-formula> are either 1 or 0 (see Figure S3 for simulations demonstrating M/SAGE’s performance on categorical data). In the partial volume simulations, the ground-truth state time-courses, <inline-formula><mml:math id="M244" altimg="si22.svg"><mml:mi>α</mml:mi></mml:math></inline-formula> could be any continuous number from 0 to 1 for any state, but where the sum of <inline-formula><mml:math id="M245" altimg="si22.svg"><mml:mi>α</mml:mi></mml:math></inline-formula> for all states, <inline-formula><mml:math id="M246" altimg="si69.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> at any time-point, t, should be 1.</p>
        <p id="p0046"><xref rid="fig0003" ref-type="fig">Figure 3</xref> [A], shows illustrative examples where the number of simulated states is two and three respectively. Either one, two, or three can be active at any time point. The simulated ground-truth in <xref rid="fig0003" ref-type="fig">Fig. 3</xref>[A] is <italic>single-dynamic</italic> and the simulated state time courses (demonstrated in <xref rid="fig0003" ref-type="fig">Fig. 3</xref>[A]) are common to both the time-varying mean and correlations. We compared SAGE with the HMM to see how they recover the underlying simulated state time courses and the observation model parameters. The HMM failed to infer these state time courses accurately, as HMM is built around the assumption that only one state is active at any time point. On the other hand, SAGE does a good job of inferring these partial volume state time courses. To quantitatively assess the performance of these models, we calculated the Riemannian distance between the simulated covariances and the inferred covariances for each time point. The lower the Riemannian distance between the inferred and simulated covariance, the better the performance of the model. We can see that SAGE can accurately infer the underlying time-varying covariance, but this is not the case for the HMM.<fig id="fig0003"><label>Fig. 3</label><caption><p>Comparison of the performance of the single-dynamic approach SAGE versus HMM, using simulations of dynamic linear mixtures of FC states (i.e., partial volume) and single-dynamics dynamics (i.e., where the state dynamics of the means and correlations are tied together). <bold>[A]</bold> Two illustrative partial volume examples, comparing SAGE performance with HMM. In scenario x, two states can be simultaneously active, whereas, in scenario y, up to three states can be simultaneously active. Note that these state-time courses were common to both the time-varying mean and correlations (i.e., instantaneous FC). The bottom row of <bold>[A]</bold> shows the Riemannian distance between the inferred and simulated covariances for both HMM and SAGE. <bold>[B-C]</bold> Comparison of the performance of SAGE with HMM on a number of partial volume simulations. Each box plot shows the distribution of prediction performance results over 50 different simulations. Riemannian distance between inferred and simulated covariances was used as a measure of success in <bold>[B]</bold>, and prediction correlation between the inferred and simulated state time-courses in <bold>[C]</bold>.</p></caption><alt-text id="at0003">Fig. 3</alt-text><graphic xlink:href="gr3"/></fig></p>
        <p id="p0047"><xref rid="fig0003" ref-type="fig">Figure 3</xref> [B,C] shows the performance of the approaches across many partial volume scenarios. We varied the number of overlapping states (either 2, 3, or 4), and then compared the performance of SAGE against the HMM. For each overlapping state configuration, we generated 50 different simulations in which we varied the state time courses (% of overlap), and the observation model itself. We illustrated the Riemannian distance between the inferred and simulated covariances. We also showed the prediction correlation (not accuracy, as state time courses, are no longer categorical) between the inferred and the simulated state time courses.</p>
        <p id="p0048">Lastly, we demonstrate the performance of MAGE for scenarios where the ground-truth is such that FC is static (i.e., no fluctuations in edges of the FC matrix over time). We show that MAGE does not infer time-varying correlations when we infer more than one state for such simulations (see Figure S4). This highlights that MAGE only infers time-varying FC when the underlying FC is time-varying.</p>
      </sec>
      <sec id="sec0016">
        <label>3.2</label>
        <title>Failing to model distinct mean activity dynamics can result in homogeneous estimation of FC over time</title>
        <p id="p0049">Commonly-used SWC and HMM approaches are what we refer to as single-dynamic models, as they tend to tie the dynamics of the correlations (i.e., the FC) to be the same as the dynamics of the means of the brain activity. However, if the underlying truth is that the dynamics of the means and correlations are actually distinct from each other, then using single-dynamic approaches to infer TVFC can have negative consequences. This is because forcing <inline-formula><mml:math id="M247" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to be the same as <inline-formula><mml:math id="M248" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, when the ground truth is that they are not the same, causes the dynamics used for estimating the state-specific FC to be incorrect. This then leads to a smearing of the FC estimation over time, making it look more homogeneous than it really is.</p>
        <p id="p0050">We illustrate the mechanism of the multi-dynamic approach using a simple scenario in <xref rid="fig0001" ref-type="fig">Fig. 1</xref>[A]. Furthermore, in <xref rid="fig0001" ref-type="fig">Fig. 1</xref>[B], we demonstrate the potential benefits of the multi-dynamic approach on a simulation<xref rid="fn0002" ref-type="fn">2</xref> in which the ground truth is such that the correlation dynamics and the mean activity dynamics are not tied together. Specifically, <xref rid="fig0001" ref-type="fig">Fig. 1</xref>[B] shows the instantaneous FC estimated using SAGE or MAGE when we simulate using <xref rid="eq0001" ref-type="disp-formula">Eqs. (1)</xref>–<xref rid="eq0005" ref-type="disp-formula">(5)</xref> with <inline-formula><mml:math id="M249" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> not equal to <inline-formula><mml:math id="M250" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
        <p id="p0051">When we infer TVFC using SAGE, the single-dynamic version of MAGE (with <inline-formula><mml:math id="M251" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> set to be the same as <inline-formula><mml:math id="M252" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), there are substantially reduced fluctuations in the inferred instantaneous FC over time (i.e., FC is mapped as being near-homogeneous/static) as is often observed in TVFC estimates in real fMRI data. In contrast, the multi-dynamic version of MAGE (with <inline-formula><mml:math id="M253" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> free to be not equal to <inline-formula><mml:math id="M254" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) is better able to capture the true fluctuations in instantaneous FC over time.</p>
      </sec>
      <sec id="sec0017">
        <label>3.3</label>
        <title>MAGE can infer dynamics in the FC that are distinct from dynamics in the means of brain activity</title>
        <p id="p0052">We next sought to see if MAGE could identify multi-dynamics in a range of scenarios. For this, we simulated distinct dynamics (i.e., multi-dynamics) for the mean and correlations (i.e., the FC) by simulating two different state time courses, <inline-formula><mml:math id="M255" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M256" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, using two different hidden semi-Markov model chains, whose state lifetime values were sampled from two different gamma distributions such that <inline-formula><mml:math id="M257" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> was not equal to <inline-formula><mml:math id="M258" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. These state time courses were then used in <xref rid="eq0001" ref-type="disp-formula">Eqs. (1)</xref>–<xref rid="eq0005" ref-type="disp-formula">(5)</xref> to simulate the data.</p>
        <p id="p0053">We compared the performance of the multi-dynamic approach (MAGE) with the single-dynamic approach (SAGE) in <xref rid="fig0004" ref-type="fig">Fig. 4</xref>[A,B]. As illustrated in <xref rid="fig0004" ref-type="fig">Fig. 4</xref>[A], the lifetimes of both the mean and correlation states in the simulation were sampled from the gamma distribution. However, we fixed the distribution of lifetimes of the correlation state time courses by setting the gamma distribution parameter to k=30, whereas, for the mean state time courses, we varied k from 5 to 80, so that the mean state time courses spanned a variety of timescales in different scenarios. In <xref rid="fig0004" ref-type="fig">Fig. 4</xref>[B], it is the other way around, where we fixed the lifetime distribution of the mean state time courses (k =30), but varied the lifetime distribution for the correlation state time-courses (again from k = 5 to 80). In <xref rid="fig0004" ref-type="fig">Fig. 4</xref>[A,B], we have plotted the prediction accuracy for the state time courses of correlation and mean. MAGE does a better job in predicting the underlying simulated labels for state time-courses as compared to SAGE. Note that we did not draw any comparison with the HMM here, as the HMM is also a single-dynamic approach, and the HMM is not able to infer the mean and correlation in such a multi-dynamic fashion (and hence the results would be expected to be closest to SAGE).<fig id="fig0004"><label>Fig. 4</label><caption><p>Comparison of the performance of the multi-dynamic approach (MAGE) and the single-dynamics approach (SAGE) on multi-dynamic simulations where multi-dynamics are the ground truth (i.e., where the state dynamics of the means and correlations are free to fluctuate independently). <bold>[A,B]</bold> The prediction performance of multi-dynamic and single-dynamic approaches are compared across a range of simulations. The x-axis shows the lifetime parameter (sampled from a gamma distribution) for the mean and correlation state time-courses, whereas the y-axis shows the prediction accuracy of the inferred state time-courses. Specifically, in <bold>[A]</bold>, we fixed the lifetime distribution of the correlation state time-courses (k = 30, as shown by the shaded bar) but varied the lifetime distribution for the mean state time-courses (from k = 5 to 80), and it is the other way around in <bold>[B]</bold>.</p></caption><alt-text id="at0004">Fig. 4</alt-text><graphic xlink:href="gr4"/></fig></p>
      </sec>
      <sec id="sec0018">
        <label>3.4</label>
        <title>MAGE learns network state dynamics that show appropriate task dependencies</title>
        <p id="p0054">In order to help validate the different dynamics that MAGE is inferring, we applied it to task fMRI data. The idea is to train MAGE with no knowledge of the task timings (i.e., unsupervised), allowing us to see if the state dynamics being inferred by MAGE are meaningful in the sense that they exhibit dynamics that link to the task. Furthermore, we wanted to compare how the FC varies across the task conditions using the MAGE approach (and judge whether the inferred spatial maps are meaningful).</p>
        <p id="p0055">Task fMRI data used was collected as part of a previous study from 15 healthy volunteers (7 females, 8 males, age = 27.3<inline-formula><mml:math id="M259" altimg="si70.svg"><mml:mo>±</mml:mo></mml:math></inline-formula>4.4yr, all right-handed) without any previous neurological disorders (<xref rid="bib0033" ref-type="bibr">Kieliba, Madugula, Filippini, Duff, Makin, 2019</xref>, <xref rid="bib0013" ref-type="bibr">Duff, Makin, Cottaar, Smith, Woolrich, 2018</xref>). Participants performed four different tasks: rest, motor only, visual only, and simultaneous (but independent) visual and motor tasks, and each task was repeated four different times. The motor task involved continuous finger-tapping against the thumb using the right hand. The vision task consisted of videos of colourful abstract shapes in motion. During the combined motor-visual task, participants performed the finger-tapping task while simultaneously watching the videos. We applied a framework used for identifying large-scale probabilistic functional modes (PROFUMO) (<xref rid="bib0026" ref-type="bibr">Harrison, Woolrich, Robinson, Glasser, Beckmann, Jenkinson, Smith, 2015</xref>, <xref rid="bib0025" ref-type="bibr">Harrison, Bijsterbosch, Segerdahl, Fitzgibbon, Farahibozorg, Duff, Smith, Woolrich, 2020</xref>), to identify parcels that are allowed to be correlated with each other in space and/or time, and which explicitly models between-subject variability in the parcels. We applied PROFUMO on this data with a dimensionality of 30, which outputs 30 parcel time-courses. These then correspond to the N=30 channels of data that are fed into MAGE.</p>
        <p id="p0056"><italic>Temporal Dynamics</italic> In the main results shown in <xref rid="fig0005" ref-type="fig">Fig. 5</xref>, we modelled four states using MAGE, so that the number of states is matched to the number of task conditions. In <xref rid="fig0005" ref-type="fig">Fig. 5</xref>[A], we have plotted the task-evoked occupancy, which is the average of the MAGE inferred state time courses across the four repeated runs (as each experimental condition is repeated four times). The task-evoked occupancy shows clearly that the inferred states switch at the same time as the experimental task condition changes. It is worth noting from <xref rid="fig0005" ref-type="fig">Fig. 5</xref>[A] that the estimated FC-driven state-time courses, <inline-formula><mml:math id="M260" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, performed better than the mean activity/variance-driven time-courses, <inline-formula><mml:math id="M261" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Moreover, in Figure S7, we have illustrated the results of task decoding when we modelled more than 4 states. In Figure S7[A], we have modelled 8 states and in Figure S7[B], we have modelled 16 states, and we plotted the relative fractional occupancy (time spent in each state) distribution for each of the modelled states. It is evident that even with the increased number of states, we can still see dynamics that are task dependent and can identify task-specific states (as highlighted by the paired <italic>t</italic>-test values on the respective states).<fig id="fig0005"><label>Fig. 5</label><caption><p><bold>[task fMRI data]</bold> Validation of the performance of MAGE on a on a real task fMRI data-set. <bold>[A]</bold> There are four different tasks performed by the participants (rest, visual, motor, and visual-motor). Task-evoked occupancy plots of the state time courses from MAGE (learnt with no knowledge of the task timings) across the four tasks, where the x-axis represents the number of time points and the y-axis corresponds to the average activation value for that state. Specifically, the task-evoked plot curves show the mean and standard deviation across four repeated runs of each experimental condition for all 15 subjects. <bold>[B]</bold> The state-specific spatial maps for the functional connectivity (FC) and mean activity, which are labelled according to the task conditions that their state time courses most correspond to. The state-specific spatial maps for variance are not illustrated as there is no between-state variability in the inferred variance states. For the mean activity maps, the average amplitude of each node/channel is shown. The negative mean activity (e.g., deactivation of the visual network during the motor task) refers to decreases in signal change compared to the baseline. For the FC maps, rank-one decompositions (first Eigenvector) of the estimated state-specific FC correlation matrices are shown. The magnitude of the values of the state-specific FC spatial maps (colorbars) correspond to the degree of connectedness of each region with the rest of brain.</p></caption><alt-text id="at0005">Fig. 5</alt-text><graphic xlink:href="gr5"/></fig></p>
        <p id="p0057">
<italic>Spatial Dynamics</italic>
</p>
        <p id="p0058">In <xref rid="fig0005" ref-type="fig">Fig. 5</xref>[B], we show the state-specific FC spatial maps (corresponding to the first eigenvector of the state-specific correlation matrices) and mean activity spatial maps for each of the four inferred states. The variance spatial maps are not illustrated as there was no between-state variability in the inferred variance states (lack of time-varying content in variance). The maps are labelled according to the task conditions that their state time courses most correspond to. The state-specific FC maps for MAGE identifies appropriate active regions during each of the tasks. It can be seen during the motor task that the somatomotor area of the brain is active, and during the visual task that the visual cortex is active. During the rest task, the Default Mode Network (DMN) is active, and during the visual-motor task, both the motor and visual cortex are active. The mean activity level maps appear fairly similar and look appropriate with regards to the relevant task condition. During the visual task, the visual cortex of the brain is active, and during the motor task, the motor cortex is active for both approaches. During the rest task, DMN is active, and during the visual-motor task, only the visual cortex is active for the MAGE approach.</p>
      </sec>
      <sec id="sec0019">
        <label>3.5</label>
        <title>Multi-dynamic approach reveals stronger changes in FC over time in resting fMRI</title>
        <p id="p0059">The simulations shown in <xref rid="fig0001" ref-type="fig">Fig. 1</xref> suggest that multi-dynamic approaches may be better able to identify TVFC than single-dynamic approaches, which may erroneously infer FC as being too homogeneous over time. We looked to test this idea by applying the single-dynamic (SAGE) and multi-dynamic (MAGE) approaches to resting-state fMRI data. In particular, we can analyse how the temporal dynamics of mean activity levels and FC differ (i.e., <inline-formula><mml:math id="M262" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M263" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) when modelled independently and see if this has any effect on the inferred state-specific FC maps. Lastly, we compared MAGE results with the HMM and SWC approaches, to further substantiate our findings.</p>
        <p id="p0060">We used rfMRI data from 13,301 subjects from the UK Biobank (UKB) (<xref rid="bib0048" ref-type="bibr">Miller et al., 2016</xref>) and 1003 subjects from the Human Connectome Project (HCP) (<xref rid="bib0063" ref-type="bibr">Van Essen et al., 2013</xref>). The pre-processing pipelines for UKB and HCP main steps can be summarized as (1) motion correction, (2) removal of structural artifacts with ICA (Independent Component Analysis and FMRIB’s ICA-based X-noisefier (FIX). The length of the scanning session for UKB is 6 min, and for HCP is 1 h (4 sessions of 15 mins each). For UKB, we have 490 time-points and for HCP, we used data from all 4 sessions which gave us 4800 time points in total (1200 time points in each session). Lastly, we applied a popular data-driven parcellation scheme called spatial Group Independent Component Analysis (group-ICA) (<xref rid="bib0053" ref-type="bibr">Pervaiz et al., 2020</xref>)<xref rid="fn0003" ref-type="fn">3</xref> to our data to identify the parcels/channels (N) that form the data to be input into MAGE<xref rid="fn0004" ref-type="fn">4</xref></p>
        <p id="p0061"><italic>Temporal and Spatial Dynamics</italic> We first compare the single-dynamic (SAGE) and multi-dynamic (MAGE) approaches using the HCP data, where the only difference between the two methods is whether or not we model independent state dynamics for the state means and FC (i.e., correlations). In <xref rid="fig0006" ref-type="fig">Fig. 6</xref>[A], we show the state-specific mean activity and FC correlation maps for SAGE and MAGE approaches for the HCP data. In total, we modelled P=Q=R=12 states, but we have only displayed the observation model for four of the 12 states for ease of visualisation (the results for all 12 states are illustrated in Figure S9, Figure S10, Figure S11 and Figure S12). As described earlier, MAGE also models time-varying variances, whose dynamics are tied to be the same as the mean. However, we have not displayed the state-specific spatial maps for variance as MAGE infers that there was little between-state variability in the state-specific variances (i.e., the variances remained static across states).<fig id="fig0006"><label>Fig. 6</label><caption><p><bold>[HCP data] [A-B]</bold> The multi-dynamic (MAGE) approach reveals stronger changes in state-specific FC maps compared to the single-dynamic (SAGE) approach. Using the HCP data, it is evident that qualitatively and quantitatively, MAGE-derived FC shows stronger changes over time. <bold>[A]</bold> State-specific mean activity and FC correlation maps for four of the modelled states for both approaches are shown. For the state-specific mean activity maps, the average amplitude of each node/channel is shown and for the state-specific FC maps, rank-one decomposition (first Eigenvector) of the estimated FC correlation maps are shown. <bold>[B]</bold> The pair-wise Riemannian distance of the state-specific FC correlation matrices between 12 FC states is shown for both MAGE and SAGE (with and without modelling the mean activity, see <xref rid="bib0068" ref-type="bibr">Vidaurre et al. (2021)</xref> as another example of modelling only the correlation, i.e., <inline-formula><mml:math id="M264" altimg="si1.svg"><mml:msub><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> = 0 in <xref rid="eq0001" ref-type="disp-formula">Eq. (1)</xref>). The stars referred to paired <italic>t</italic>-test values. <bold>[C]</bold> Correlations between the mean-derived state time-courses and the FC-derived state time-courses plotted as histogram over all pairs of states (and equivalent null scenario). The non-zero correlations indicate that the mean activity and FC have some shared dynamics but also have unique temporal dynamics. <bold>[D]</bold> Summary measures of the state dynamics for both approaches. It can be seen that FC state dynamics show the lowest switching rate (in Hertz) and the highest lifetimes values (in seconds) as compared to other approaches. <bold>(E)</bold> Example segment of a state time course of a randomly chosen subject is shown to qualitatively highlight the extent of similarity (and dissimilarity) between the mean activity and the FC state time courses. These also show how states in MAGE can overlap in time.</p></caption><alt-text id="at0006">Fig. 6</alt-text><graphic xlink:href="gr6"/></fig></p>
        <p id="p0062"><xref rid="fig0006" ref-type="fig">Figure 6</xref> [A] shows that the state-specific mean activity maps vary reasonably well across states using both SAGE and MAGE. However, with SAGE, it can be seen that the state-specific FC maps (the rank-one decomposition of the estimated state-specific correlation maps are shown to make these 2D FC maps easier to view) of all the states are predominantly similar, always resembling a somatomotor state. We also attempted another modelling option with SAGE in which we explicitly forced the mean activity to be zero<xref rid="fn0005" ref-type="fn">5</xref> (i.e., <inline-formula><mml:math id="M265" altimg="si1.svg"><mml:msub><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> = 0 in <xref rid="eq0001" ref-type="disp-formula">Eq. (1)</xref>). This approach also resulted in homogeneous state-specific FCs as shown in Figure S13. In contrast, for the MAGE approach, we can see that the state-specific FC maps correspond to distinct brain networks, with the state-specific FCs looking more distinct from each other than in the SAGE results. To illustrate this quantitatively, we show the pairwise between-state Riemannian distance in <xref rid="fig0006" ref-type="fig">Fig. 6</xref>[B]. Specifically, we calculated these pairwise distances over the actual 2D correlation matrices (i.e., FCs). It is clear that these between-state pairwise distances are higher for the state-specific FC maps when inferred using the multi-dynamic MAGE approach, revealing stronger changes in FC over time.</p>
        <p id="p0063">In <xref rid="fig0006" ref-type="fig">Fig. 6</xref>[D], we compare summary measures of the state dynamics. Since MAGE models a linear mixture (i.e., a partial volume) at each time point, it is not straightforward to compute summary statistics normally used on binary state time courses. In order to allow us to do this we threshold the continuous partial volume state time courses (<inline-formula><mml:math id="M266" altimg="si13.svg"><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M267" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) at 0.3. Firstly, we show the state switching rate for both models, which is a measure of the frequency of state fluctuation for each subject, and it can be seen that FC-driven state time-courses, <inline-formula><mml:math id="M268" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, have the lowest switching rate. Then, we show the state lifetimes for both models, which correspond to the number of seconds per state visit. We can see that the FC-driven state time-courses have the highest values for state lifetimes (2 to 5 s) as compare to lifetimes of mean state time-courses (2 to 3 s). In <xref rid="fig0006" ref-type="fig">Fig. 6</xref>[E], we show an example segment of the state time course (of a randomly chosen subject) showing the nature of the mixing of the inferred 12 states and the degree of overlap between the mean activity and the FC state time-courses. Furthermore, in <xref rid="fig0006" ref-type="fig">Fig. 6</xref>[C], we quantitatively compare the extent of similarity between the mean activity and the FC state time courses. We plot the mean activity and the FC state time courses correlation matrices as histograms for the null and the HCP dataset. There is a significant non-zero correlation as compared to the equivalent null scenario, but there is clearly still a distinct difference between them (and hence the difference in the performance of SAGE vs MAGE). In short, the means and FCs have some shared dynamics but also some unique/independent dynamics.</p>
        <p id="p0064">It has been previously proposed that the observed estimates of TVFC must be compared against “static” null hypotheses to establish claims of non-stationary (<xref rid="bib0043" ref-type="bibr">Lurie et al., 2020</xref>). Considering that, we generated null data using autoregressive randomization (ARR) following (<xref rid="bib0038" ref-type="bibr">Liegeois et al., 2017</xref>). Specifically, a 10th order Gaussian autoregressive (AR) model was applied to generate null data. For each participant and each pair of brain regions, we compared the observed between-timepoint variances of the instantaneous FCs inferred by MAGE, which can be calculated from the FC state dynamics and state-specific FCs, from the real HCP data against the null data. This analysis resulted in one p-value for each edge of the FC matrix. On average, across HCP participants (compared against null data), 95% of edges were significant (<inline-formula><mml:math id="M269" altimg="si71.svg"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>). Furthermore, in Figure S5, we show the histogram of null variance values compared with the real HCP data variance values (this highlights that between-brain region variability over time is significantly higher in the real HCP data as compared to null data).</p>
        <p id="p0065">We find that we get similar results to the HCP dataset when we use MAGE on the resting fMRI data from the UKB dataset. Here, we also compare the performance of MAGE with other established methods (HMM and SWC) on the UKB data-set. <xref rid="fig0007" ref-type="fig">Figure 7</xref> shows the state-specific FC maps from MAGE, HMM and SWC, with the HMM and SWC approaches showing similar behaviour to that of SAGE in <xref rid="fig0006" ref-type="fig">Fig. 6</xref>. It is also clear that there are smaller between-state differences in FC across time for both the HMM and SWC approaches compared to MAGE (as reflected by the between-state Riemannian distance plots in <xref rid="fig0007" ref-type="fig">Fig. 7</xref>[D]), consistent again with the idea that MAGE reveals stronger changes in FC over time due to its ability to model multi-dynamics.<fig id="fig0007"><label>Fig. 7</label><caption><p><bold>[UKB data]</bold> Demonstration that the between-state spatial variability in state-specific FC maps is significantly higher when modelled using the MAGE approach on UKB data compared with the HMM or SWC approaches. <bold>[A-C]</bold> The pair-wise Riemannian distance of the state-specific FC correlation matrices between 12 FC states is shown for MAGE, HMM and SWC, alongside the FC correlation maps for 5 of the identified states. The state-specific FC maps are shown as rank-one decomposition (first Eigenvector) of the estimated state-specific FC correlation matrices. The channels with positive values (red regions) show they are positively correlated with other regions, whereas channels with negative values (blue regions) show they are negatively correlated with other regions. The state-specific FC maps for all 12 states using SWC, HMM and MAGE are illustrated in Figure S14, Figure S15, and Figure S16 respectively. <bold>[D]</bold> The between-state Riemannian distance for the modelled 12 states, shown for MAGE, SWC and HMM. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></caption><alt-text id="at0007">Fig. 7</alt-text><graphic xlink:href="gr7"/></fig></p>
        <p id="p0066">To ensure that the MAGE estimated FC and mean activity states are reproducible, we ran MAGE six times on different non-overlapping subsets of UKB data (2k subjects for each run). In <xref rid="fig0008" ref-type="fig">Fig. 8</xref>[A,B], we compare the similarity between MAGE estimated state-specific spatial maps across the six runs. Specifically, in <xref rid="fig0008" ref-type="fig">Fig. 8</xref>[A], we show the average correlation plot for the state-specific FC estimates across repeated runs, and in <xref rid="fig0008" ref-type="fig">Fig. 8</xref>[B] for the state-specific mean activity estimates, both for a fixed number of states (P=Q=12). This shows that the state-specific FCs are very reproducible and that the state-specific mean activity estimates are moderately reproducible but not to the same extent. We then replicated these reproducibility findings for a wide range of numbers of states (1 to 24) for the FC and mean activity, as shown in <xref rid="fig0008" ref-type="fig">Fig. 8</xref>[C], also demonstrating that P does not have to be equal to Q. We show in <xref rid="fig0008" ref-type="fig">Fig. 8</xref>[C] that the FC are mostly highly and mean activity are mostly moderately reproducible independent of the number of modelled states. Specifically, mean activity and functional connectivity states are more reproducible if the number of modelled states is more than approximately six.<fig id="fig0008"><label>Fig. 8</label><caption><p><bold>[UKB data]</bold> MAGE estimated FC and mean activity spatial maps are reproducible across various runs on different non-overlapping sets of subjects. <bold>[A]</bold> shows the average correlation between the state-specific FCs across six repeated runs. Moreover, for runs 1 and 2, FC correlation maps are shown for 4 of the identified states (out of the 12 inferred states), demonstrating that the FC states are consistent across repeated runs. On the other hand, <bold>[B]</bold> shows the average correlation plot for the state-specific mean activity estimates across six repeated runs, alongside the mean activity spatial maps (for runs 1 and 2 only). The analysis in <bold>[A]</bold> and <bold>[B]</bold> is performed for a fixed number of states (P = Q = 12), whereas, in <bold>[C]</bold>, we evaluated the reproducibility of state-specific FC and mean activity estimates by varying the total number of modelled states (P, Q). Specifically, <bold>[C]</bold> shows the correlation plots for the state-specific FCs and state-specific mean activity estimates, where we varied the total number of inferred states (P and Q) from 1 to 24. These results suggest that inferred states for the FC are highly and mean activity are moderately reproducible independent of the number of modelled states (Note the difference in the ranges of the colormaps). <bold>[D]</bold> We replicated the original findings of (<xref rid="bib0069" ref-type="bibr">Vidaurre et al., 2017</xref>) and illustrate that hierarchical meta-state structure exists both in the functional connectivity and the mean activity states, but is more well-defined in the mean activity states (matrices computed as <inline-formula><mml:math id="M270" altimg="si2.svg"><mml:mrow><mml:mi>υ</mml:mi><mml:msup><mml:mi>υ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="M271" altimg="si3.svg"><mml:mi>υ</mml:mi></mml:math></inline-formula> is the [number of states by number of subjects] fractional occupancy matrix).</p></caption><alt-text id="at0008">Fig. 8</alt-text><graphic xlink:href="gr8"/></fig></p>
        <p id="p0067">It has been previously reported in <xref rid="bib0069" ref-type="bibr">Vidaurre et al. (2017)</xref> that the brain network activity is organized into a hierarchy of two distinct meta-states, with one meta-state representing hisgher-order cognition, and the other representing the sensorimotor systems. We have taken a similar approach as <xref rid="bib0069" ref-type="bibr">Vidaurre et al. (2017)</xref>, and computed [P x d] or [Q x d] matrices containing the fractional occupancy (time spent in each state) for each subject, where d is the number of subjects. We then use these to compute the [P x P] or [Q x Q] correlation matrices over subjects, which are shown in <xref rid="fig0008" ref-type="fig">Fig. 8</xref>[D]. As in <xref rid="bib0069" ref-type="bibr">Vidaurre et al. (2017)</xref>, <xref rid="fig0008" ref-type="fig">Fig. 8</xref>[D] shows that a hierarchical meta-state structure is present. Here, it is apparent in both in the functional connectivity and the mean activity driven state time-courses, although it is more apparent in the mean activity state time-courses.</p>
      </sec>
      <sec id="sec0020">
        <label>3.6</label>
        <title>Multi-dynamic TVFC predicts behavioural variability better than the single-dynamic approaches</title>
        <p id="p0068">We next used the UKB data to see if the multi-dynamic MAGE approach provides spatial network features (i.e., the state-specific FCs) that can be used to predict individual behavioural traits, and we compare its performance to the HMM and SWC approaches. Alongside the task fMRI results, this would provide further evidence that the state dynamics being inferred by MAGE are cognitively meaningful.</p>
        <p id="p0069">We applied the dual-estimation method to obtain subject-level estimates of TVFC. This means that for each subject, we can obtain a set of state-specific FC maps (Q * N * N), where Q is the number of correlation (FC) states and N is the number of channels/brain regions. Then, we can use these subject-level, state-specific FC estimates to predict selected behavioural variables. The classifier/predictor we employed is Elastic Net (<xref rid="bib0071" ref-type="bibr">Zou and Hastie, 2005</xref>), which is a regularized regression method that combines the penalties of lasso <inline-formula><mml:math id="M272" altimg="si72.svg"><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> and ridge <inline-formula><mml:math id="M273" altimg="si73.svg"><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> methods (<xref rid="bib0066" ref-type="bibr">Vidaurre et al., 2013</xref>). The data matrix fed into the classifier is d*[Q*f], where d is the number of subjects, Q is the number of states and f is the number of features. The state-specific FC matrices are symmetric and only values above the diagonal need to be retained and vectorized, and hence f = N(N-1)/2. Lastly, we concatenated the state-by-state subject-level, state-specific FC estimates, resulting in Q*f features for each subject. We performed this prediction analysis for UKB data with d = 13301, Q = 12, and N = 25.</p>
        <p id="p0070">We used four non-imaging variables to compare the performance of multi-dynamic (MAGE) approach with HMM and SWC. The details for the SWC and HMM approaches are explained in the Section S1.3 and Section S1.4 respectively. These variables are age, sex, fluid intelligence score, and neuroticism score. In <xref rid="fig0009" ref-type="fig">Fig. 9</xref>[A], we display the prediction results (nested 10-fold cross-validated) from the subject-level FC estimates. We can see that the FC obtained using the MAGE approach is a more accurate predictor of behaviour as compared to the other approaches<fig id="fig0009"><label>Fig. 9</label><caption><p>Multi-dynamic (MAGE) derived state-specific FCs are used to predict non-imaging variables in the UKB data. <bold>[A]</bold> The prediction performance of MAGE-derived state-specific FCs compared with the HMM and SWC approaches. The prediction accuracy/correlation is estimated using the combined features by concatenating the state-specific FC estimates from all states. Y-axis shows the prediction correlation (age, fluid intelligence, neuroticism) and prediction accuracy (sex), and the x-axis shows the predicted variable. To draw the confidence intervals on the prediction accuracies for sex variable (discrete output), we performed the Wilson test (suitable for the binomial distribution). Lastly, to generate confidence intervals on the prediction correlations (i.e., continuous outputs e.g., age, fluid intelligence and neuroticism), we computed the Fisher transformation (<xref rid="bib0053" ref-type="bibr">Pervaiz et al., 2020</xref>). <bold>[B]</bold> Comparison of the prediction performance of MAGE-derived state-specific FCs with the time-averaged FC. The bars in red colour show the prediction correlation/accuracy using time-averaged FC estimates, whereas bars in green show the increased/decreased prediction correlation/accuracy using state-specific FC estimates. The numbers in red bars represent the percentage in the change of performance using the state-specific FCs as compared to time-averaged FC. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></caption><alt-text id="at0009">Fig. 9</alt-text><graphic xlink:href="gr9"/></fig></p>
      </sec>
      <sec id="sec0021">
        <label>3.7</label>
        <title>Static FC is worse than multi-dynamic TVFC at predicting behaviour</title>
        <p id="p0071">Time-averaged FC (static) can be considered as an average of all state-specific FC states (and the time varying means) and is conventionally estimated simply by taking a full (Pearson) correlation between brain parcels over the whole scanning time. Unlike TVFC in the form of the state-specific FCs, time-averaged FC is a single FC estimate per subject and is already an established predictor of behavioural traits (<xref rid="bib0053" ref-type="bibr">Pervaiz et al., 2020</xref>). In <xref rid="fig0009" ref-type="fig">Fig. 9</xref>[B], we compare the combined power of the state-specific FCs with the time-averaged FC. This shows that for the mental health variables, predictive performance is improved by using the state-specific FCs in comparison to time-averaged FC. We employed Elastic Net for this comparison and the reported results are nested 10-fold cross-validated.</p>
      </sec>
    </sec>
    <sec id="sec0022">
      <label>4</label>
      <title>Discussion</title>
      <p id="p0072">We have proposed a novel algorithm, MAGE, that reliably infers the time-point by time-point estimates of FC. Notably, MAGE frees up the dynamics of the FC to fluctuate independently from the dynamics of the means and variances of the brain activity. We found that this multi-dynamic approach reveals much stronger changes in FC over time than existing single-dynamic approaches (e.g., HMM, SWC), and is a better predictor of individual behavioural variability. This provides a potential explanation and solution as to why time-varying FC has appeared to look so stable in resting fMRI data in previous work (<xref rid="bib0029" ref-type="bibr">Hindriks, Adhikari, Murayama, Ganzetti, Mantini, Logothetis, Deco, 2016</xref>, <xref rid="bib0038" ref-type="bibr">Liegeois, Laumann, Snyder, Zhou, Yeo, 2017</xref>).</p>
      <p id="p0073"><bold>MAGE inferred multi-dynamic linear mixtures of FC states.</bold> We assessed the performance of MAGE on simulations where there can be more than one underlying state active at each time point (<xref rid="fig0003" ref-type="fig">Fig. 3</xref>). We demonstrated that categorical models, such as the HMM, under-performed as expected when applied to such simulations. In contrast, MAGE remained accurate across a range of these simulations. MAGE also shows improved performance in simulations designed to be suitable for categorical models (e.g., HMM), i.e., by having only one state active at each time point (mutual exclusivity) (Figure S3). This suggests that MAGE performance remained stable when the state time-courses have long-range temporal dependencies (i.e., violate the HMM Markovian assumption) (Figure S3[D]). Lastly, we assessed the performance on the multi-dynamic simulations and demonstrated that MAGE accurately identified unique dynamics of the correlations when the ground truth was that the correlations and mean activity dynamics were distinct from each other (<xref rid="fig0004" ref-type="fig">Fig. 4</xref>).</p>
      <p id="p0074"><bold>MAGE learned network state dynamics that showed appropriate task dependencies.</bold> Following rigorous performance evaluation of MAGE on more than a thousand simulations, we applied it to a task fMRI dataset. The rationale was that task fMRI gives an opportunity to assess the specific state dynamics that MAGE infers, by comparing them to the known task timings. In <xref rid="fig0005" ref-type="fig">Fig. 5</xref>, we demonstrated that the FC-driven time courses performed well in terms of displaying task-dependencies as compared to the mean-driven state time courses when using MAGE. Moreover, we showed in <xref rid="fig0005" ref-type="fig">Fig. 5</xref>[B] that plausible time-varying representations of FC and mean activity spatial maps were inferred using the MAGE approach. This suggests that the inferred TVFC is powerful enough to capture the dynamics in cognitive tasks, and is not static during these task experiments.</p>
      <p id="p0075"><bold>Why do we model the mean of the brain activity separately from the functional connectivity?</bold> Our assumption in <xref rid="eq0001" ref-type="disp-formula">Eq. (1)</xref> is that the mean and the FC (i.e., the correlation matrix) continuously vary over time. From that perspective, there is no imperative to assume that the dynamics of those two entities are the same as each other. As such, MAGE is designed to explore what happens when we do not tie the dynamics together. By allowing the state dynamics of the mean and FC to be independent of each other, MAGE also allows them to potentially operate on different time scales. However, in real fMRI data, we found that the dynamics of the mean states and the FC states ended up on fairly similar time-scales (between 2 to 5 s for FC states and 2 to 3 s for mean activity states, as shown in <xref rid="fig0006" ref-type="fig">Fig. 6</xref>). It is also interesting to consider the extent to which the state dynamics of the mean and FC get inferred as being coupled together, despite being free to be inferred as completely independent. <xref rid="fig0006" ref-type="fig">Figure 6</xref>[C] demonstrated that there was indeed some significant non-zero correlation between the two types of dynamics. However, this correspondence between the dynamics of the mean and the dynamics of the FC was not absolute. In other words, the fluctuations in the FC clearly have some unique temporal structure that is not shared with the fluctuations in the mean of the activity. Indeed, the benefit of capturing these unique fluctuations was demonstrated by the improved performance of MAGE (versus SAGE) in inferring stronger fluctuations in FC over time and in predicting behavioural traits.</p>
      <p id="p0076"><bold>Why does MAGE reveal stronger functional connectivity dynamics in resting-state fMRI?</bold> Our results demonstrated that MAGE revealed stronger changes in FC over time than single-dynamic approaches, where changes in FC over time correspond to between-state differences in the state-specific FCs (e.g., HMM, SWC, SAGE, see <xref rid="fig0006" ref-type="fig">Figs. 6</xref> and <xref rid="fig0007" ref-type="fig">7</xref>). The lack of change in FC over time in single-dynamic approaches has been observed in other, recent studies (<xref rid="bib0036" ref-type="bibr">Laumann, Snyder, Mitra, Gordon, Gratton, Adeyemo, Gilmore, Nelson, Berg, Greene, et al., 2017</xref>, <xref rid="bib0029" ref-type="bibr">Hindriks, Adhikari, Murayama, Ganzetti, Mantini, Logothetis, Deco, 2016</xref>, <xref rid="bib0037" ref-type="bibr">Leonardi, Van De Ville, 2015</xref>). Indeed, in some cases, it has been observed that the reported variability in the FC from one state to another state (or against null models) is statistically insignificant (<xref rid="bib0038" ref-type="bibr">Liegeois et al., 2017</xref>). So why does MAGE show comparatively stronger changes in FC over time? We can gain insight into the multi-dynamic model being used in MAGE, by considering a dynamic version of structural equation modelling (SEM), as explained in <xref rid="sec0023" ref-type="sec">Appendix A</xref>. This shows that if the underlying truth is that there are distinct dynamics for the external driving inputs and connectivity, then distinct dynamics are needed for the mean activity and FC modelled by MAGE. If we were to ignore this, and use a single dynamic approach (e.g., HMM, SAGE, SWC) then we will infer common state dynamics that are a compromise. In turn, use of these incorrect state dynamics will tend to cause the inferred FC patterns to be temporally smeared versions of the true FC patterns, causing them to look more homogeneous over time. We demonstrated this phenomenon with a simple example (<xref rid="fig0001" ref-type="fig">Fig. 1</xref>[B]), in which we simulated a ground truth where the FC dynamics and the mean activity dynamics were not tied together. Using SAGE on this data substantially reduced the inferred change in instantaneous FC over time, whereas MAGE better captured the true variability in instantaneous FC across time. This work provides a potential explanation as to why FC in resting fMRI has previously appeared to look so homogeneous over time (<xref rid="bib0036" ref-type="bibr">Laumann, Snyder, Mitra, Gordon, Gratton, Adeyemo, Gilmore, Nelson, Berg, Greene, et al., 2017</xref>, <xref rid="bib0029" ref-type="bibr">Hindriks, Adhikari, Murayama, Ganzetti, Mantini, Logothetis, Deco, 2016</xref>, <xref rid="bib0038" ref-type="bibr">Liegeois, Laumann, Snyder, Zhou, Yeo, 2017</xref>).</p>
      <p id="p0077"><bold>Reproducibility of MAGE states.</bold> The presented results in <xref rid="fig0008" ref-type="fig">Fig. 8</xref> demonstrated that the MAGE estimated FC states are highly and mean activity states are moderately reproducible across re-runs on non-overlapping subsets of the data (shown quantitatively and qualitatively in <xref rid="fig0008" ref-type="fig">Fig. 8</xref>[A,B]). Also, as is typical with other unsupervised learning methods (e.g., ICA, HMM), the number of states to be modelled is an empirical parameter in our method and it needs to be chosen before running the model. In most of our presented work, we modelled anywhere from 4 to 16 states, though we had experimented with up-to 64 states in the resting-state and task data (and the results remained sensible). In <xref rid="fig0008" ref-type="fig">Fig. 8</xref>[C], we found out the estimated states are more consistent across re-runs when the number of modelled states is more than six. Considering that, we suggest that the number of modelled states to be more than approximately six for such dynamic modelling (though we do not have a strong recommendation for an exact number of states).</p>
      <p id="p0078"><bold>Multi-dynamic TVFC predicted behavioural variability better than existing methods.</bold> We evaluated whether the inter-individual differences inferred by MAGE are meaningful. We demonstrated in <xref rid="fig0009" ref-type="fig">Fig. 9</xref>[A] that the MAGE-estimated, state-specific FCs did a better job at predicting these non-imaging variables as compared to SWC and HMM approaches. For example, age was predicted with an average correlation of 0.50 using MAGE as compared to 0.46 using HMM, and 0.36 using SWC. This provides evidence that the TVFC estimated using the MAGE is a more accurate and meaningful representation of underlying functional networks and is indeed a powerful biomarker for cognitive traits.</p>
      <p id="p0079"><bold>Static FC is worse than Multi-dynamic TVFC at predicting behaviour.</bold> In <xref rid="fig0009" ref-type="fig">Fig. 9</xref>[B], we compared the predictive power of MAGE-derived, state-specific FCs versus time-averaged FC, and demonstrated the prediction performance on mental-health related variables in UKB data. We have demonstrated that the prediction accuracy of these behavioural variables increased when TVFC was used, as compared to time-averaged FC e.g., for work/job satisfaction, prediction accuracy was improved by 20.2% and for depressed for a week, accuracy was improved by 19.5%, etc. This highlights that there are some aspects of behaviour that can be best explained using TVFC estimates. The better performance of time-varying FC in terms of behavioural variability might be because it should not contain as much potential confounding anatomical information as compared to time-averaged FC (<xref rid="bib0068" ref-type="bibr">Vidaurre et al., 2021</xref>); however, further detailed work is require to understand and address this issue.</p>
      <p id="p0080"><bold>What do we mean by TVFC?</bold> We can gain insight into the multi-dynamic model being proposed, by considering a dynamic version of structural equation modelling (SEM) as explained in <xref rid="sec0023" ref-type="sec">Appendix A</xref>. The SEM perspective (<xref rid="sec0023" ref-type="sec">Appendix A</xref>) suggests that the instantaneous FC is the closest representation that we have to the time-varying connectivity in a dynamic SEM (<xref rid="eq0019" ref-type="disp-formula">Eq. (19)</xref>). In MAGE, we have assumed that the instantaneous FC, <inline-formula><mml:math id="M274" altimg="si4.svg"><mml:msub><mml:mi>C</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, is the TVFC measure of most interest. MAGE provides a regularised estimate of the instantaneous FC, and so in this paper we have represented the instantaneous FC parsimoniously using the state-specific FCs. Hence, in this work we have focussed on the state-specific FCs as our main measure of TVFC, e.g., for predicting behavioural traits. However, a more complete representation of TVFC includes the FC state time courses alongside the state-specific FCs (after all, we combine the state-specific FCs with the FC state time courses via <xref rid="eq0004" ref-type="disp-formula">Eq. (4)</xref> to get the instantaneous FC). As such, prediction may be improved further in the future by including features describing the FC state dynamics. For example, we can already show that inter-individual differences for the time spent in each FC state are linked to behavioural traits, as illustrated in Figure S8. MAGE also provides other potential features for use in prediction, for example, the mean-activity FC (i.e., correlations of the mean activity, <inline-formula><mml:math id="M275" altimg="si1.svg"><mml:msub><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, over all time) or the state-specific mean activity and the mean-derived dynamics. In this paper, we have not looked into the details of mean-activity FC but mean-activity FC has been assessed in the literature. For example, <xref rid="bib0049" ref-type="bibr">Miller et al. (2015)</xref> highlights that the spatiotemporal organization of brain activity correlates with the presence of diagnosed schizophrenia, as well as with gender and age.</p>
      <p id="p0081"><bold>Variance of the brain activity.</bold> We found through resting-state and task data-sets results (<xref rid="fig0006" ref-type="fig">Figs. 6</xref> and <xref rid="fig0007" ref-type="fig">7</xref>) that there was not much between-state variability in the variance of the activity, and the variance remained static over the scanning session. Nevertheless, we explored another configuration where dynamics of the variance of the activity was modelled with independent state dynamics from the mean activity and the FC, but that also did not result in any meaningful variability in the variance of the activity (though it is computationally more expensive to learn the variance state time courses separately). We also attempted to model state dynamics of the variance of the activity tied to the state dynamics of the FC fluctuations, but independently from the mean activity; however, this resulted in comparatively less between-state variability in the FC. In summary, we found out there was little between-state variability in the state-specific variances irrespective of the modelling choice.</p>
      <p id="p0082">In summary, we proposed a multi-dynamic approach (MAGE) that models temporal fluctuations in functional connectivity independently from fluctuations in the mean of the activity. Multi-dynamic modelling provided an explanation and a solution as to why resting fMRI FC has previously looked so stable and homogeneous. We found out that that separating fluctuations in the mean activity levels from those in the functional connectivity reveals much stronger changes in functional connectivity over time. Lastly, MAGE estimated time-varying FC is a better predictor of behavioural variability in the resting-state fMRI data than established methods.</p>
    </sec>
    <sec id="sec0022a">
      <title>CRediT authorship contribution statement</title>
      <p id="p0082a"><bold>Usama Pervaiz:</bold> Data curation, Conceptualization, Methodology, Writing – original draft, Validation, Visualization. <bold>Diego Vidaurre:</bold> Methodology, Writing – review &amp; editing, Supervision. <bold>Chetan Gohil:</bold> Methodology, Writing – review &amp; editing. <bold>Stephen M. Smith:</bold> Data curation, Conceptualization, Writing – review &amp; editing, Validation, Supervision. <bold>Mark W. Woolrich:</bold> Conceptualization, Methodology, Writing – original draft, Writing – review &amp; editing, Validation, Visualization, Supervision.</p>
    </sec>
    <sec sec-type="COI-statement">
      <title>Declaration of Competing Interest</title>
      <p id="p0083">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p>
    </sec>
  </body>
  <back>
    <ref-list id="bib001">
      <title>References</title>
      <ref id="bib0001">
        <element-citation publication-type="journal" id="sbref0001">
          <person-group person-group-type="author">
            <name>
              <surname>Abrol</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Rashid</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Rachakonda</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Damaraju</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Calhoun</surname>
              <given-names>V.D.</given-names>
            </name>
          </person-group>
          <article-title>Schizophrenia shows disrupted links between brain volume and dynamic functional connectivity</article-title>
          <source>Front. Neurosci.</source>
          <volume>11</volume>
          <year>2017</year>
          <fpage>624</fpage>
          <pub-id pub-id-type="pmid">29163021</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0002">
        <element-citation publication-type="journal" id="sbref0002">
          <person-group person-group-type="author">
            <name>
              <surname>Allen</surname>
              <given-names>E.A.</given-names>
            </name>
            <name>
              <surname>Damaraju</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Plis</surname>
              <given-names>S.M.</given-names>
            </name>
            <name>
              <surname>Erhardt</surname>
              <given-names>E.B.</given-names>
            </name>
            <name>
              <surname>Eichele</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Calhoun</surname>
              <given-names>V.D.</given-names>
            </name>
          </person-group>
          <article-title>Tracking whole-brain connectivity dynamics in the resting state</article-title>
          <source>Cereb. Cortex</source>
          <volume>24</volume>
          <issue>3</issue>
          <year>2014</year>
          <fpage>663</fpage>
          <lpage>676</lpage>
          <pub-id pub-id-type="pmid">23146964</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0003">
        <element-citation publication-type="journal" id="sbref0003">
          <person-group person-group-type="author">
            <name>
              <surname>Anand</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Li</surname>
              <given-names>Y.</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>Y.</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Gao</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Bukhari</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Mathews</surname>
              <given-names>V.P.</given-names>
            </name>
            <name>
              <surname>Kalnin</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Lowe</surname>
              <given-names>M.J.</given-names>
            </name>
          </person-group>
          <article-title>Activity and connectivity of brain mood regulating circuit in depression: a functional magnetic resonance study</article-title>
          <source>Biol. Psychiatry</source>
          <volume>57</volume>
          <issue>10</issue>
          <year>2005</year>
          <fpage>1079</fpage>
          <lpage>1088</lpage>
          <pub-id pub-id-type="pmid">15866546</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0004">
        <element-citation publication-type="journal" id="sbref0004">
          <person-group person-group-type="author">
            <name>
              <surname>Baker</surname>
              <given-names>A.P.</given-names>
            </name>
            <name>
              <surname>Brookes</surname>
              <given-names>M.J.</given-names>
            </name>
            <name>
              <surname>Rezek</surname>
              <given-names>I.A.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
            <name>
              <surname>Behrens</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>P.J.P.</given-names>
            </name>
            <name>
              <surname>Woolrich</surname>
              <given-names>M.</given-names>
            </name>
          </person-group>
          <article-title>Fast transient networks in spontaneous human brain activity</article-title>
          <source>Elife</source>
          <volume>3</volume>
          <year>2014</year>
          <fpage>e01867</fpage>
          <pub-id pub-id-type="pmid">24668169</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0005">
        <element-citation publication-type="journal" id="sbref0005">
          <person-group person-group-type="author">
            <name>
              <surname>Beckmann</surname>
              <given-names>C.F.</given-names>
            </name>
            <name>
              <surname>Mackay</surname>
              <given-names>C.E.</given-names>
            </name>
            <name>
              <surname>Filippini</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
          </person-group>
          <article-title>Group comparison of resting-state FMRI data using multi-subject ICA and dual regression</article-title>
          <source>Neuroimage</source>
          <volume>47</volume>
          <issue>Suppl 1</issue>
          <year>2009</year>
          <fpage>S148</fpage>
        </element-citation>
      </ref>
      <ref id="bib0006">
        <element-citation publication-type="journal" id="sbref0006">
          <person-group person-group-type="author">
            <name>
              <surname>Biswal</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Zerrin Yetkin</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Haughton</surname>
              <given-names>V.M.</given-names>
            </name>
            <name>
              <surname>Hyde</surname>
              <given-names>J.S.</given-names>
            </name>
          </person-group>
          <article-title>Functional connectivity in the motor cortex of resting human brain using echo-planar MRI</article-title>
          <source>Magn. Reson. Med.</source>
          <volume>34</volume>
          <issue>4</issue>
          <year>1995</year>
          <fpage>537</fpage>
          <lpage>541</lpage>
          <pub-id pub-id-type="pmid">8524021</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0007">
        <element-citation publication-type="journal" id="sbref0007">
          <person-group person-group-type="author">
            <name>
              <surname>Cai</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Liu</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Mi</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Garg</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Trappe</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>McKeown</surname>
              <given-names>M.J.</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>Z.J.</given-names>
            </name>
          </person-group>
          <article-title>Dynamic graph theoretical analysis of functional connectivity in Parkinson’s disease: the importance of fiedler value</article-title>
          <source>IEEE J. Biomed. Health Inform.</source>
          <volume>23</volume>
          <issue>4</issue>
          <year>2018</year>
          <fpage>1720</fpage>
          <lpage>1729</lpage>
          <pub-id pub-id-type="pmid">30307882</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0008">
        <element-citation publication-type="journal" id="sbref0008">
          <person-group person-group-type="author">
            <name>
              <surname>Charquero-Ballester</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Kleim</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Vidaurre</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Ruff</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Stark</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Tuulari</surname>
              <given-names>J.J.</given-names>
            </name>
            <name>
              <surname>McManners</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Bar-Haim</surname>
              <given-names>Y.</given-names>
            </name>
            <name>
              <surname>Bouquillon</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Moseley</surname>
              <given-names>A.</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Effective psychological treatment for PTSD changes the dynamics of specific large-scale brain networks</article-title>
          <source>BioRxiv</source>
          <year>2020</year>
        </element-citation>
      </ref>
      <ref id="bib0009">
        <element-citation publication-type="journal" id="sbref0009">
          <person-group person-group-type="author">
            <name>
              <surname>Chen</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Sun</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Shi</surname>
              <given-names>Y.</given-names>
            </name>
            <name>
              <surname>Jin</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>Y.</given-names>
            </name>
            <name>
              <surname>Xi</surname>
              <given-names>Q.</given-names>
            </name>
            <name>
              <surname>Ren</surname>
              <given-names>C.</given-names>
            </name>
          </person-group>
          <article-title>Alterations of static functional connectivity and dynamic functional connectivity in motor execution regions after stroke</article-title>
          <source>Neurosci. Lett.</source>
          <volume>686</volume>
          <year>2018</year>
          <fpage>112</fpage>
          <lpage>121</lpage>
          <pub-id pub-id-type="pmid">30195973</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0010">
        <element-citation publication-type="journal" id="sbref0010">
          <person-group person-group-type="author">
            <name>
              <surname>De Luca</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Beckmann</surname>
              <given-names>C.F.</given-names>
            </name>
            <name>
              <surname>De Stefano</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Matthews</surname>
              <given-names>P.M.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
          </person-group>
          <article-title>FMRI resting state networks define distinct modes of long-distance interactions in the human brain</article-title>
          <source>Neuroimage</source>
          <volume>29</volume>
          <issue>4</issue>
          <year>2006</year>
          <fpage>1359</fpage>
          <lpage>1367</lpage>
          <pub-id pub-id-type="pmid">16260155</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0011">
        <element-citation publication-type="journal" id="sbref0011">
          <person-group person-group-type="author">
            <name>
              <surname>De Pasquale</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Della Penna</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Snyder</surname>
              <given-names>A.Z.</given-names>
            </name>
            <name>
              <surname>Lewis</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Mantini</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Marzetti</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Belardinelli</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Ciancetta</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Pizzella</surname>
              <given-names>V.</given-names>
            </name>
            <name>
              <surname>Romani</surname>
              <given-names>G.L.</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Temporal dynamics of spontaneous meg activity in brain networks</article-title>
          <source>Proc. Natl. Acad. Sci.</source>
          <volume>107</volume>
          <issue>13</issue>
          <year>2010</year>
          <fpage>6040</fpage>
          <lpage>6045</lpage>
          <pub-id pub-id-type="pmid">20304792</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0012">
        <element-citation publication-type="journal" id="sbref0012">
          <person-group person-group-type="author">
            <name>
              <surname>De Pasquale</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Della Penna</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Snyder</surname>
              <given-names>A.Z.</given-names>
            </name>
            <name>
              <surname>Marzetti</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Pizzella</surname>
              <given-names>V.</given-names>
            </name>
            <name>
              <surname>Romani</surname>
              <given-names>G.L.</given-names>
            </name>
            <name>
              <surname>Corbetta</surname>
              <given-names>M.</given-names>
            </name>
          </person-group>
          <article-title>A cortical core for dynamic integration of functional networks in the resting human brain</article-title>
          <source>Neuron</source>
          <volume>74</volume>
          <issue>4</issue>
          <year>2012</year>
          <fpage>753</fpage>
          <lpage>764</lpage>
          <pub-id pub-id-type="pmid">22632732</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0013">
        <element-citation publication-type="journal" id="sbref0013">
          <person-group person-group-type="author">
            <name>
              <surname>Duff</surname>
              <given-names>E.P.</given-names>
            </name>
            <name>
              <surname>Makin</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Cottaar</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
            <name>
              <surname>Woolrich</surname>
              <given-names>M.W.</given-names>
            </name>
          </person-group>
          <article-title>Disambiguating brain functional connectivity</article-title>
          <source>Neuroimage</source>
          <volume>173</volume>
          <year>2018</year>
          <fpage>540</fpage>
          <lpage>550</lpage>
          <pub-id pub-id-type="pmid">29476911</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0014">
        <element-citation publication-type="journal" id="sbref0014">
          <person-group person-group-type="author">
            <name>
              <surname>d’Ambrosio</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Valsasina</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Gallo</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>De Stefano</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Pareto</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Barkhof</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Ciccarelli</surname>
              <given-names>O.</given-names>
            </name>
            <name>
              <surname>Enzinger</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Tedeschi</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Stromillo</surname>
              <given-names>M.L.</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Reduced dynamics of functional connectivity and cognitive impairment in multiple sclerosis</article-title>
          <source>Mult. Scler. J.</source>
          <volume>26</volume>
          <issue>4</issue>
          <year>2020</year>
          <fpage>476</fpage>
          <lpage>488</lpage>
        </element-citation>
      </ref>
      <ref id="bib0015">
        <element-citation publication-type="journal" id="sbref0015">
          <person-group person-group-type="author">
            <name>
              <surname>Fox</surname>
              <given-names>M.D.</given-names>
            </name>
            <name>
              <surname>Raichle</surname>
              <given-names>M.E.</given-names>
            </name>
          </person-group>
          <article-title>Spontaneous fluctuations in brain activity observed with functional magnetic resonance imaging</article-title>
          <source>Nat. Rev. Neurosci.</source>
          <volume>8</volume>
          <issue>9</issue>
          <year>2007</year>
          <fpage>700</fpage>
          <lpage>711</lpage>
          <pub-id pub-id-type="pmid">17704812</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0016">
        <element-citation publication-type="journal" id="sbref0016">
          <person-group person-group-type="author">
            <name>
              <surname>Fox</surname>
              <given-names>M.D.</given-names>
            </name>
            <name>
              <surname>Snyder</surname>
              <given-names>A.Z.</given-names>
            </name>
            <name>
              <surname>Vincent</surname>
              <given-names>J.L.</given-names>
            </name>
            <name>
              <surname>Corbetta</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Van Essen</surname>
              <given-names>D.C.</given-names>
            </name>
            <name>
              <surname>Raichle</surname>
              <given-names>M.E.</given-names>
            </name>
          </person-group>
          <article-title>The human brain is intrinsically organized into dynamic, anticorrelated functional networks</article-title>
          <source>Proc. Natl. Acad. Sci.</source>
          <volume>102</volume>
          <issue>27</issue>
          <year>2005</year>
          <fpage>9673</fpage>
          <lpage>9678</lpage>
          <pub-id pub-id-type="pmid">15976020</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0017">
        <element-citation publication-type="journal" id="sbref0017">
          <person-group person-group-type="author">
            <name>
              <surname>Friston</surname>
              <given-names>K.</given-names>
            </name>
            <name>
              <surname>Mattout</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Trujillo-Barreto</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Ashburner</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Penny</surname>
              <given-names>W.</given-names>
            </name>
          </person-group>
          <article-title>Variational free energy and the laplace approximation</article-title>
          <source>Neuroimage</source>
          <volume>34</volume>
          <issue>1</issue>
          <year>2007</year>
          <fpage>220</fpage>
          <lpage>234</lpage>
          <pub-id pub-id-type="pmid">17055746</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0018">
        <element-citation publication-type="journal" id="sbref0018">
          <person-group person-group-type="author">
            <name>
              <surname>Gers</surname>
              <given-names>F.A.</given-names>
            </name>
            <name>
              <surname>Schmidhuber</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Cummins</surname>
              <given-names>F.</given-names>
            </name>
          </person-group>
          <article-title>Learning to forget: continual prediction with LSTM</article-title>
          <source>Neural Comput.</source>
          <volume>12</volume>
          <issue>10</issue>
          <year>2000</year>
          <fpage>2451</fpage>
          <lpage>2471</lpage>
          <pub-id pub-id-type="pmid">11032042</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0019">
        <mixed-citation publication-type="other" id="sbref0019">Goodfellow, I. J., Pouget-Abadie, J., Mirza, M., Xu, B., Warde-Farley, D., Ozair, S., Courville, A., Bengio, Y., 2014. Generative adversarial networks. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1406.2661" id="intrrf0004">arXiv preprint arXiv:1406.2661</ext-link>.</mixed-citation>
      </ref>
      <ref id="bib0020">
        <element-citation publication-type="journal" id="sbref0020">
          <person-group person-group-type="author">
            <name>
              <surname>Graves</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Schmidhuber</surname>
              <given-names>J.</given-names>
            </name>
          </person-group>
          <article-title>Framewise phoneme classification with bidirectional LSTM and other neural network architectures</article-title>
          <source>Neural Netw.</source>
          <volume>18</volume>
          <issue>5–6</issue>
          <year>2005</year>
          <fpage>602</fpage>
          <lpage>610</lpage>
          <pub-id pub-id-type="pmid">16112549</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0021">
        <element-citation publication-type="journal" id="sbref0021">
          <person-group person-group-type="author">
            <name>
              <surname>Greicius</surname>
              <given-names>M.D.</given-names>
            </name>
            <name>
              <surname>Srivastava</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Reiss</surname>
              <given-names>A.L.</given-names>
            </name>
            <name>
              <surname>Menon</surname>
              <given-names>V.</given-names>
            </name>
          </person-group>
          <article-title>Default-mode network activity distinguishes Alzheimer’s disease from healthy aging: evidence from functional MRI</article-title>
          <source>Proc. Natl. Acad. Sci.</source>
          <volume>101</volume>
          <issue>13</issue>
          <year>2004</year>
          <fpage>4637</fpage>
          <lpage>4642</lpage>
          <pub-id pub-id-type="pmid">15070770</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0022">
        <element-citation publication-type="journal" id="sbref0022">
          <person-group person-group-type="author">
            <name>
              <surname>Guo</surname>
              <given-names>X.</given-names>
            </name>
            <name>
              <surname>Duan</surname>
              <given-names>X.</given-names>
            </name>
            <name>
              <surname>Suckling</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Liao</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>Cui</surname>
              <given-names>Q.</given-names>
            </name>
            <name>
              <surname>Chen</surname>
              <given-names>H.</given-names>
            </name>
          </person-group>
          <article-title>Partially impaired functional connectivity states between right anterior insula and default mode network in autism spectrum disorder</article-title>
          <source>Hum. Brain Mapp.</source>
          <volume>40</volume>
          <issue>4</issue>
          <year>2019</year>
          <fpage>1264</fpage>
          <lpage>1275</lpage>
          <pub-id pub-id-type="pmid">30367744</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0023">
        <element-citation publication-type="journal" id="sbref0023">
          <person-group person-group-type="author">
            <name>
              <surname>Hacker</surname>
              <given-names>C.D.</given-names>
            </name>
            <name>
              <surname>Perlmutter</surname>
              <given-names>J.S.</given-names>
            </name>
            <name>
              <surname>Criswell</surname>
              <given-names>S.R.</given-names>
            </name>
            <name>
              <surname>Ances</surname>
              <given-names>B.M.</given-names>
            </name>
            <name>
              <surname>Snyder</surname>
              <given-names>A.Z.</given-names>
            </name>
          </person-group>
          <article-title>Resting state functional connectivity of the striatum in Parkinson’s disease</article-title>
          <source>Brain</source>
          <volume>135</volume>
          <issue>12</issue>
          <year>2012</year>
          <fpage>3699</fpage>
          <lpage>3711</lpage>
          <pub-id pub-id-type="pmid">23195207</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0024">
        <element-citation publication-type="journal" id="sbref0024">
          <person-group person-group-type="author">
            <name>
              <surname>Hahn</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Stein</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Windischberger</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Weissenbacher</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Spindelegger</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Moser</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Kasper</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Lanzenberger</surname>
              <given-names>R.</given-names>
            </name>
          </person-group>
          <article-title>Reduced resting-state functional connectivity between amygdala and orbitofrontal cortex in social anxiety disorder</article-title>
          <source>Neuroimage</source>
          <volume>56</volume>
          <issue>3</issue>
          <year>2011</year>
          <fpage>881</fpage>
          <lpage>889</lpage>
          <pub-id pub-id-type="pmid">21356318</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0025">
        <element-citation publication-type="journal" id="sbref0025">
          <person-group person-group-type="author">
            <name>
              <surname>Harrison</surname>
              <given-names>S.J.</given-names>
            </name>
            <name>
              <surname>Bijsterbosch</surname>
              <given-names>J.D.</given-names>
            </name>
            <name>
              <surname>Segerdahl</surname>
              <given-names>A.R.</given-names>
            </name>
            <name>
              <surname>Fitzgibbon</surname>
              <given-names>S.P.</given-names>
            </name>
            <name>
              <surname>Farahibozorg</surname>
              <given-names>S.-R.</given-names>
            </name>
            <name>
              <surname>Duff</surname>
              <given-names>E.P.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
            <name>
              <surname>Woolrich</surname>
              <given-names>M.W.</given-names>
            </name>
          </person-group>
          <article-title>Modelling subject variability in the spatial and temporal characteristics of functional modes</article-title>
          <source>Neuroimage</source>
          <volume>222</volume>
          <year>2020</year>
          <fpage>117226</fpage>
          <pub-id pub-id-type="pmid">32771617</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0026">
        <element-citation publication-type="journal" id="sbref0026">
          <person-group person-group-type="author">
            <name>
              <surname>Harrison</surname>
              <given-names>S.J.</given-names>
            </name>
            <name>
              <surname>Woolrich</surname>
              <given-names>M.W.</given-names>
            </name>
            <name>
              <surname>Robinson</surname>
              <given-names>E.C.</given-names>
            </name>
            <name>
              <surname>Glasser</surname>
              <given-names>M.F.</given-names>
            </name>
            <name>
              <surname>Beckmann</surname>
              <given-names>C.F.</given-names>
            </name>
            <name>
              <surname>Jenkinson</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
          </person-group>
          <article-title>Large-scale probabilistic functional modes from resting state FMRI</article-title>
          <source>Neuroimage</source>
          <volume>109</volume>
          <year>2015</year>
          <fpage>217</fpage>
          <lpage>231</lpage>
          <pub-id pub-id-type="pmid">25598050</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0027">
        <element-citation publication-type="journal" id="sbref0027">
          <person-group person-group-type="author">
            <name>
              <surname>Higgins</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Liu</surname>
              <given-names>Y.</given-names>
            </name>
            <name>
              <surname>Vidaurre</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Kurth-Nelson</surname>
              <given-names>Z.</given-names>
            </name>
            <name>
              <surname>Dolan</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Behrens</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Woolrich</surname>
              <given-names>M.</given-names>
            </name>
          </person-group>
          <article-title>Replay bursts in humans coincide with activation of the default mode and parietal alpha networks</article-title>
          <source>Neuron</source>
          <volume>109</volume>
          <issue>5</issue>
          <year>2021</year>
          <fpage>882</fpage>
          <lpage>893</lpage>
          <pub-id pub-id-type="pmid">33357412</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0028">
        <mixed-citation publication-type="other" id="sbref0028">Higgins, I., Matthey, L., Pal, A., Burgess, C., Glorot, X., Botvinick, M., Mohamed, S., Lerchner, A., 2016. beta-VAE: learning basic visual concepts with a constrained variational framework.</mixed-citation>
      </ref>
      <ref id="bib0029">
        <element-citation publication-type="journal" id="sbref0029">
          <person-group person-group-type="author">
            <name>
              <surname>Hindriks</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Adhikari</surname>
              <given-names>M.H.</given-names>
            </name>
            <name>
              <surname>Murayama</surname>
              <given-names>Y.</given-names>
            </name>
            <name>
              <surname>Ganzetti</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Mantini</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Logothetis</surname>
              <given-names>N.K.</given-names>
            </name>
            <name>
              <surname>Deco</surname>
              <given-names>G.</given-names>
            </name>
          </person-group>
          <article-title>Can sliding-window correlations reveal dynamic functional connectivity in resting-state FMRI?</article-title>
          <source>Neuroimage</source>
          <volume>127</volume>
          <year>2016</year>
          <fpage>242</fpage>
          <lpage>256</lpage>
          <pub-id pub-id-type="pmid">26631813</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0030">
        <element-citation publication-type="book" id="sbref0030">
          <person-group person-group-type="author">
            <name>
              <surname>Huang</surname>
              <given-names>G.-H.</given-names>
            </name>
          </person-group>
          <part-title>Model Identifiability</part-title>
          <year>2014</year>
          <publisher-name>Wiley StatsRef: Statistics Reference Online</publisher-name>
          <fpage>1</fpage>
          <lpage>4</lpage>
        </element-citation>
      </ref>
      <ref id="bib0031">
        <element-citation publication-type="journal" id="sbref0031">
          <person-group person-group-type="author">
            <name>
              <surname>Huang</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Zhou</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Guo</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Zhao</surname>
              <given-names>Y.</given-names>
            </name>
            <name>
              <surname>Wan</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Li</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Zeng</surname>
              <given-names>X.</given-names>
            </name>
            <name>
              <surname>Gong</surname>
              <given-names>H.</given-names>
            </name>
          </person-group>
          <article-title>White matter lesion loads associated with dynamic functional connectivity within attention network in patients with relapsing-remitting multiple sclerosis</article-title>
          <source>J. Clin. Neurosci.</source>
          <volume>65</volume>
          <year>2019</year>
          <fpage>59</fpage>
          <lpage>65</lpage>
          <pub-id pub-id-type="pmid">30940453</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0032">
        <element-citation publication-type="journal" id="sbref0032">
          <person-group person-group-type="author">
            <name>
              <surname>Hutchison</surname>
              <given-names>R.M.</given-names>
            </name>
            <name>
              <surname>Womelsdorf</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Allen</surname>
              <given-names>E.A.</given-names>
            </name>
            <name>
              <surname>Bandettini</surname>
              <given-names>P.A.</given-names>
            </name>
            <name>
              <surname>Calhoun</surname>
              <given-names>V.D.</given-names>
            </name>
            <name>
              <surname>Corbetta</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Della Penna</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Duyn</surname>
              <given-names>J.H.</given-names>
            </name>
            <name>
              <surname>Glover</surname>
              <given-names>G.H.</given-names>
            </name>
            <name>
              <surname>Gonzalez-Castillo</surname>
              <given-names>J.</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Dynamic functional connectivity: promise, issues, and interpretations</article-title>
          <source>Neuroimage</source>
          <volume>80</volume>
          <year>2013</year>
          <fpage>360</fpage>
          <lpage>378</lpage>
          <pub-id pub-id-type="pmid">23707587</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0033">
        <element-citation publication-type="journal" id="sbref0033">
          <person-group person-group-type="author">
            <name>
              <surname>Kieliba</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Madugula</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Filippini</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Duff</surname>
              <given-names>E.P.</given-names>
            </name>
            <name>
              <surname>Makin</surname>
              <given-names>T.R.</given-names>
            </name>
          </person-group>
          <article-title>Large-scale intrinsic connectivity is consistent across varying task demands</article-title>
          <source>PLoS ONE</source>
          <volume>14</volume>
          <issue>4</issue>
          <year>2019</year>
          <fpage>e0213861</fpage>
          <pub-id pub-id-type="pmid">30970031</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0034">
        <mixed-citation publication-type="other" id="sbref0034">Kingma, D. P., Welling, M., 2013. Auto-encoding variational bayes. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1312.6114" id="intrrf0005">arXiv preprint arXiv:1312.6114</ext-link>.</mixed-citation>
      </ref>
      <ref id="bib0035">
        <element-citation publication-type="journal" id="sbref0035">
          <person-group person-group-type="author">
            <name>
              <surname>Klugah-Brown</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Luo</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>He</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Jiang</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Armah</surname>
              <given-names>G.K.</given-names>
            </name>
            <name>
              <surname>Wu</surname>
              <given-names>Y.</given-names>
            </name>
            <name>
              <surname>Li</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Yin</surname>
              <given-names>W.</given-names>
            </name>
            <name>
              <surname>Yao</surname>
              <given-names>D.</given-names>
            </name>
          </person-group>
          <article-title>Altered dynamic functional network connectivity in frontal lobe epilepsy</article-title>
          <source>Brain Topogr.</source>
          <volume>32</volume>
          <issue>3</issue>
          <year>2019</year>
          <fpage>394</fpage>
          <lpage>404</lpage>
          <pub-id pub-id-type="pmid">30255350</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0036">
        <element-citation publication-type="journal" id="sbref0036">
          <person-group person-group-type="author">
            <name>
              <surname>Laumann</surname>
              <given-names>T.O.</given-names>
            </name>
            <name>
              <surname>Snyder</surname>
              <given-names>A.Z.</given-names>
            </name>
            <name>
              <surname>Mitra</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Gordon</surname>
              <given-names>E.M.</given-names>
            </name>
            <name>
              <surname>Gratton</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Adeyemo</surname>
              <given-names>B.</given-names>
            </name>
            <name>
              <surname>Gilmore</surname>
              <given-names>A.W.</given-names>
            </name>
            <name>
              <surname>Nelson</surname>
              <given-names>S.M.</given-names>
            </name>
            <name>
              <surname>Berg</surname>
              <given-names>J.J.</given-names>
            </name>
            <name>
              <surname>Greene</surname>
              <given-names>D.J.</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>On the stability of bold FMRI correlations</article-title>
          <source>Cereb. Cortex</source>
          <volume>27</volume>
          <issue>10</issue>
          <year>2017</year>
          <fpage>4719</fpage>
          <lpage>4732</lpage>
          <pub-id pub-id-type="pmid">27591147</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0037">
        <element-citation publication-type="journal" id="sbref0037">
          <person-group person-group-type="author">
            <name>
              <surname>Leonardi</surname>
              <given-names>N.</given-names>
            </name>
            <name>
              <surname>Van De Ville</surname>
              <given-names>D.</given-names>
            </name>
          </person-group>
          <article-title>On spurious and real fluctuations of dynamic functional connectivity during rest</article-title>
          <source>Neuroimage</source>
          <volume>104</volume>
          <year>2015</year>
          <fpage>430</fpage>
          <lpage>436</lpage>
          <pub-id pub-id-type="pmid">25234118</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0038">
        <element-citation publication-type="journal" id="sbref0038">
          <person-group person-group-type="author">
            <name>
              <surname>Liegeois</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Laumann</surname>
              <given-names>T.O.</given-names>
            </name>
            <name>
              <surname>Snyder</surname>
              <given-names>A.Z.</given-names>
            </name>
            <name>
              <surname>Zhou</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Yeo</surname>
              <given-names>B.T.</given-names>
            </name>
          </person-group>
          <article-title>Interpreting temporal fluctuations in resting-state functional connectivity MRI</article-title>
          <source>Neuroimage</source>
          <volume>163</volume>
          <year>2017</year>
          <fpage>437</fpage>
          <lpage>455</lpage>
          <pub-id pub-id-type="pmid">28916180</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0039">
        <element-citation publication-type="journal" id="sbref0039">
          <person-group person-group-type="author">
            <name>
              <surname>Liégeois</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Li</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Kong</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Orban</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Van De Ville</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Ge</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Sabuncu</surname>
              <given-names>M.R.</given-names>
            </name>
            <name>
              <surname>Yeo</surname>
              <given-names>B.T.</given-names>
            </name>
          </person-group>
          <article-title>Resting brain dynamics at different timescales capture distinct aspects of human behavior</article-title>
          <source>Nat. Commun.</source>
          <volume>10</volume>
          <issue>1</issue>
          <year>2019</year>
          <fpage>1</fpage>
          <lpage>9</lpage>
          <pub-id pub-id-type="pmid">30602773</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0040">
        <element-citation publication-type="journal" id="sbref0040">
          <person-group person-group-type="author">
            <name>
              <surname>Liégeois</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Ziegler</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Phillips</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Geurts</surname>
              <given-names>P.</given-names>
            </name>
            <name>
              <surname>Gómez</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Bahri</surname>
              <given-names>M.A.</given-names>
            </name>
            <name>
              <surname>Yeo</surname>
              <given-names>B.T.</given-names>
            </name>
            <name>
              <surname>Soddu</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Vanhaudenhuyse</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Laureys</surname>
              <given-names>S.</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Cerebral functional connectivity periodically (de) synchronizes with anatomical constraints</article-title>
          <source>Brain Struct. Funct.</source>
          <volume>221</volume>
          <issue>6</issue>
          <year>2016</year>
          <fpage>2985</fpage>
          <lpage>2997</lpage>
          <pub-id pub-id-type="pmid">26197763</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0041">
        <element-citation publication-type="journal" id="sbref0041">
          <person-group person-group-type="author">
            <name>
              <surname>Lindquist</surname>
              <given-names>M.A.</given-names>
            </name>
            <name>
              <surname>Xu</surname>
              <given-names>Y.</given-names>
            </name>
            <name>
              <surname>Nebel</surname>
              <given-names>M.B.</given-names>
            </name>
            <name>
              <surname>Caffo</surname>
              <given-names>B.S.</given-names>
            </name>
          </person-group>
          <article-title>Evaluating dynamic bivariate correlations in resting-state FMRI: a comparison study and a new approach</article-title>
          <source>Neuroimage</source>
          <volume>101</volume>
          <year>2014</year>
          <fpage>531</fpage>
          <lpage>546</lpage>
          <pub-id pub-id-type="pmid">24993894</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0042">
        <element-citation publication-type="book" id="sbref0042">
          <person-group person-group-type="author">
            <name>
              <surname>Lowd</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Meek</surname>
              <given-names>C.</given-names>
            </name>
          </person-group>
          <part-title>Adversarial learning</part-title>
          <source>Proceedings of the Eleventh ACM SIGKDD International Conference on Knowledge Discovery in Data Mining</source>
          <year>2005</year>
          <fpage>641</fpage>
          <lpage>647</lpage>
        </element-citation>
      </ref>
      <ref id="bib0043">
        <element-citation publication-type="journal" id="sbref0043">
          <person-group person-group-type="author">
            <name>
              <surname>Lurie</surname>
              <given-names>D.J.</given-names>
            </name>
            <name>
              <surname>Kessler</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Bassett</surname>
              <given-names>D.S.</given-names>
            </name>
            <name>
              <surname>Betzel</surname>
              <given-names>R.F.</given-names>
            </name>
            <name>
              <surname>Breakspear</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Kheilholz</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Kucyi</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Liégeois</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Lindquist</surname>
              <given-names>M.A.</given-names>
            </name>
            <name>
              <surname>McIntosh</surname>
              <given-names>A.R.</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Questions and controversies in the study of time-varying functional connectivity in resting FMRI</article-title>
          <source>Netw. Neurosci.</source>
          <volume>4</volume>
          <issue>1</issue>
          <year>2020</year>
          <fpage>30</fpage>
          <lpage>69</lpage>
          <pub-id pub-id-type="pmid">32043043</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0044">
        <element-citation publication-type="journal" id="sbref0044">
          <person-group person-group-type="author">
            <name>
              <surname>Lynall</surname>
              <given-names>M.-E.</given-names>
            </name>
            <name>
              <surname>Bassett</surname>
              <given-names>D.S.</given-names>
            </name>
            <name>
              <surname>Kerwin</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>McKenna</surname>
              <given-names>P.J.</given-names>
            </name>
            <name>
              <surname>Kitzbichler</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Muller</surname>
              <given-names>U.</given-names>
            </name>
            <name>
              <surname>Bullmore</surname>
              <given-names>E.</given-names>
            </name>
          </person-group>
          <article-title>Functional connectivity and brain networks in schizophrenia</article-title>
          <source>J. Neurosci.</source>
          <volume>30</volume>
          <issue>28</issue>
          <year>2010</year>
          <fpage>9477</fpage>
          <lpage>9487</lpage>
          <pub-id pub-id-type="pmid">20631176</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0045">
        <mixed-citation publication-type="other" id="sbref0045">Makhzani, A., Shlens, J., Jaitly, N., Goodfellow, I., Frey, B., 2015. Adversarial autoencoders. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1511.05644" id="intrrf0006">arXiv preprint arXiv:1511.05644</ext-link>.</mixed-citation>
      </ref>
      <ref id="bib0046">
        <element-citation publication-type="journal" id="sbref0046">
          <person-group person-group-type="author">
            <name>
              <surname>Marrelec</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Benali</surname>
              <given-names>H.</given-names>
            </name>
          </person-group>
          <article-title>A theoretical investigation of the relationship between structural equation modeling and partial correlation in functional MRI effective connectivity</article-title>
          <source>Comput. Intell. Neurosci.</source>
          <volume>2009</volume>
          <year>2009</year>
        </element-citation>
      </ref>
      <ref id="bib0047">
        <element-citation publication-type="book" id="sbref0047">
          <person-group person-group-type="author">
            <name>
              <surname>Mescheder</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Nowozin</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Geiger</surname>
              <given-names>A.</given-names>
            </name>
          </person-group>
          <part-title>Adversarial variational bayes: unifying variational autoencoders and generative adversarial networks</part-title>
          <source>International Conference on Machine Learning</source>
          <year>2017</year>
          <publisher-name>PMLR</publisher-name>
          <fpage>2391</fpage>
          <lpage>2400</lpage>
        </element-citation>
      </ref>
      <ref id="bib0048">
        <element-citation publication-type="journal" id="sbref0048">
          <person-group person-group-type="author">
            <name>
              <surname>Miller</surname>
              <given-names>K.L.</given-names>
            </name>
            <name>
              <surname>Alfaro-Almagro</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Bangerter</surname>
              <given-names>N.K.</given-names>
            </name>
            <name>
              <surname>Thomas</surname>
              <given-names>D.L.</given-names>
            </name>
            <name>
              <surname>Yacoub</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Xu</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Bartsch</surname>
              <given-names>A.J.</given-names>
            </name>
            <name>
              <surname>Jbabdi</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Sotiropoulos</surname>
              <given-names>S.N.</given-names>
            </name>
            <name>
              <surname>Andersson</surname>
              <given-names>J.L.</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Multimodal population brain imaging in the UK Biobank prospective epidemiological study</article-title>
          <source>Nat. Neurosci.</source>
          <volume>19</volume>
          <issue>11</issue>
          <year>2016</year>
          <fpage>1523</fpage>
          <lpage>1536</lpage>
          <pub-id pub-id-type="pmid">27643430</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0049">
        <element-citation publication-type="journal" id="sbref0049">
          <person-group person-group-type="author">
            <name>
              <surname>Miller</surname>
              <given-names>R.L.</given-names>
            </name>
            <name>
              <surname>Erhardt</surname>
              <given-names>E.B.</given-names>
            </name>
            <name>
              <surname>Agcaoglu</surname>
              <given-names>O.</given-names>
            </name>
            <name>
              <surname>Allen</surname>
              <given-names>E.A.</given-names>
            </name>
            <name>
              <surname>Michael</surname>
              <given-names>A.M.</given-names>
            </name>
            <name>
              <surname>Turner</surname>
              <given-names>J.A.</given-names>
            </name>
            <name>
              <surname>Bustillo</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Ford</surname>
              <given-names>J.M.</given-names>
            </name>
            <name>
              <surname>Mathalon</surname>
              <given-names>D.H.</given-names>
            </name>
            <name>
              <surname>Van Erp</surname>
              <given-names>T.G.</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Multidimensional frequency domain analysis of full-volume FMRI reveals significant effects of age, gender, and mental illness on the spatiotemporal organization of resting-state brain activity</article-title>
          <source>Front. Neurosci.</source>
          <volume>9</volume>
          <year>2015</year>
          <fpage>203</fpage>
          <pub-id pub-id-type="pmid">26136646</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0050">
        <element-citation publication-type="journal" id="sbref0050">
          <person-group person-group-type="author">
            <name>
              <surname>O’Reilly</surname>
              <given-names>J.X.</given-names>
            </name>
            <name>
              <surname>Woolrich</surname>
              <given-names>M.W.</given-names>
            </name>
            <name>
              <surname>Behrens</surname>
              <given-names>T.E.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
            <name>
              <surname>Johansen-Berg</surname>
              <given-names>H.</given-names>
            </name>
          </person-group>
          <article-title>Tools of the trade: psychophysiological interactions and functional connectivity</article-title>
          <source>Soc. Cogn. Affect. Neurosci.</source>
          <volume>7</volume>
          <issue>5</issue>
          <year>2012</year>
          <fpage>604</fpage>
          <lpage>609</lpage>
          <pub-id pub-id-type="pmid">22569188</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0051">
        <element-citation publication-type="journal" id="sbref0051">
          <person-group person-group-type="author">
            <name>
              <surname>Parr</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Rees</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Friston</surname>
              <given-names>K.J.</given-names>
            </name>
          </person-group>
          <article-title>Computational neuropsychology and Bayesian inference</article-title>
          <source>Front. Hum. Neurosci.</source>
          <volume>12</volume>
          <year>2018</year>
          <fpage>61</fpage>
          <pub-id pub-id-type="pmid">29527157</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0052">
        <element-citation publication-type="journal" id="sbref0052">
          <person-group person-group-type="author">
            <name>
              <surname>Penny</surname>
              <given-names>W.D.</given-names>
            </name>
            <name>
              <surname>Stephan</surname>
              <given-names>K.E.</given-names>
            </name>
            <name>
              <surname>Mechelli</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Friston</surname>
              <given-names>K.J.</given-names>
            </name>
          </person-group>
          <article-title>Modelling functional integration: a comparison of structural equation and dynamic causal models</article-title>
          <source>Neuroimage</source>
          <volume>23</volume>
          <year>2004</year>
          <fpage>S264</fpage>
          <lpage>S274</lpage>
          <pub-id pub-id-type="pmid">15501096</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0053">
        <element-citation publication-type="journal" id="sbref0053">
          <person-group person-group-type="author">
            <name>
              <surname>Pervaiz</surname>
              <given-names>U.</given-names>
            </name>
            <name>
              <surname>Vidaurre</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Woolrich</surname>
              <given-names>M.W.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
          </person-group>
          <article-title>Optimising network modelling methods for FMRI</article-title>
          <source>Neuroimage</source>
          <volume>211</volume>
          <year>2020</year>
          <fpage>116604</fpage>
          <pub-id pub-id-type="pmid">32062083</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0054">
        <element-citation publication-type="journal" id="sbref0054">
          <person-group person-group-type="author">
            <name>
              <surname>Quinn</surname>
              <given-names>A.J.</given-names>
            </name>
            <name>
              <surname>Vidaurre</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Abeysuriya</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Becker</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Nobre</surname>
              <given-names>A.C.</given-names>
            </name>
            <name>
              <surname>Woolrich</surname>
              <given-names>M.W.</given-names>
            </name>
          </person-group>
          <article-title>Task-evoked dynamic network analysis through hidden Markov modeling</article-title>
          <source>Front. Neurosci.</source>
          <volume>12</volume>
          <year>2018</year>
          <fpage>603</fpage>
          <pub-id pub-id-type="pmid">30210284</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0055">
        <element-citation publication-type="journal" id="sbref0055">
          <person-group person-group-type="author">
            <name>
              <surname>Rogers</surname>
              <given-names>B.P.</given-names>
            </name>
            <name>
              <surname>Morgan</surname>
              <given-names>V.L.</given-names>
            </name>
            <name>
              <surname>Newton</surname>
              <given-names>A.T.</given-names>
            </name>
            <name>
              <surname>Gore</surname>
              <given-names>J.C.</given-names>
            </name>
          </person-group>
          <article-title>Assessing functional connectivity in the human brain by FMRI</article-title>
          <source>Magn. Reson. Imaging</source>
          <volume>25</volume>
          <issue>10</issue>
          <year>2007</year>
          <fpage>1347</fpage>
          <lpage>1357</lpage>
          <pub-id pub-id-type="pmid">17499467</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0056">
        <element-citation publication-type="journal" id="sbref0056">
          <person-group person-group-type="author">
            <name>
              <surname>Sakoğlu</surname>
              <given-names>Ü.</given-names>
            </name>
            <name>
              <surname>Pearlson</surname>
              <given-names>G.D.</given-names>
            </name>
            <name>
              <surname>Kiehl</surname>
              <given-names>K.A.</given-names>
            </name>
            <name>
              <surname>Wang</surname>
              <given-names>Y.M.</given-names>
            </name>
            <name>
              <surname>Michael</surname>
              <given-names>A.M.</given-names>
            </name>
            <name>
              <surname>Calhoun</surname>
              <given-names>V.D.</given-names>
            </name>
          </person-group>
          <article-title>A method for evaluating dynamic functional network connectivity and task-modulation: application to schizophrenia</article-title>
          <source>Magn. Reson. Mater. Phys. Biol. Med.</source>
          <volume>23</volume>
          <issue>5–6</issue>
          <year>2010</year>
          <fpage>351</fpage>
          <lpage>366</lpage>
        </element-citation>
      </ref>
      <ref id="bib0057">
        <element-citation publication-type="journal" id="sbref0057">
          <person-group person-group-type="author">
            <name>
              <surname>Shimizu</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Hoyer</surname>
              <given-names>P.O.</given-names>
            </name>
            <name>
              <surname>Hyvärinen</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Kerminen</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Jordan</surname>
              <given-names>M.</given-names>
            </name>
          </person-group>
          <article-title>A linear non-gaussian acyclic model for causal discovery</article-title>
          <source>J. Mach. Learn. Res.</source>
          <volume>7</volume>
          <issue>10</issue>
          <year>2006</year>
        </element-citation>
      </ref>
      <ref id="bib0058">
        <element-citation publication-type="journal" id="sbref0058">
          <person-group person-group-type="author">
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
          </person-group>
          <article-title>The future of FMRI connectivity</article-title>
          <source>Neuroimage</source>
          <volume>62</volume>
          <issue>2</issue>
          <year>2012</year>
          <fpage>1257</fpage>
          <lpage>1266</lpage>
          <pub-id pub-id-type="pmid">22248579</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0059">
        <element-citation publication-type="journal" id="sbref0059">
          <person-group person-group-type="author">
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
            <name>
              <surname>Beckmann</surname>
              <given-names>C.F.</given-names>
            </name>
            <name>
              <surname>Andersson</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Auerbach</surname>
              <given-names>E.J.</given-names>
            </name>
            <name>
              <surname>Bijsterbosch</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Douaud</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Duff</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Feinberg</surname>
              <given-names>D.A.</given-names>
            </name>
            <name>
              <surname>Griffanti</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Harms</surname>
              <given-names>M.P.</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Resting-state FMRI in the human connectome project</article-title>
          <source>Neuroimage</source>
          <volume>80</volume>
          <year>2013</year>
          <fpage>144</fpage>
          <lpage>168</lpage>
          <pub-id pub-id-type="pmid">23702415</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0060">
        <element-citation publication-type="journal" id="sbref0060">
          <person-group person-group-type="author">
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
            <name>
              <surname>Hyvärinen</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Varoquaux</surname>
              <given-names>G.</given-names>
            </name>
            <name>
              <surname>Miller</surname>
              <given-names>K.L.</given-names>
            </name>
            <name>
              <surname>Beckmann</surname>
              <given-names>C.F.</given-names>
            </name>
          </person-group>
          <article-title>Group-PCA for very large FMRI datasets</article-title>
          <source>Neuroimage</source>
          <volume>101</volume>
          <year>2014</year>
          <fpage>738</fpage>
          <lpage>749</lpage>
          <pub-id pub-id-type="pmid">25094018</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0061">
        <element-citation publication-type="journal" id="sbref0061">
          <person-group person-group-type="author">
            <name>
              <surname>Tagliazucchi</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Von Wegner</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Morzelewski</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Brodbeck</surname>
              <given-names>V.</given-names>
            </name>
            <name>
              <surname>Laufs</surname>
              <given-names>H.</given-names>
            </name>
          </person-group>
          <article-title>Dynamic bold functional connectivity in humans and its electrophysiological correlates</article-title>
          <source>Front. Hum. Neurosci.</source>
          <volume>6</volume>
          <year>2012</year>
          <fpage>339</fpage>
          <pub-id pub-id-type="pmid">23293596</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0062">
        <element-citation publication-type="journal" id="sbref0062">
          <person-group person-group-type="author">
            <name>
              <surname>Tavor</surname>
              <given-names>I.</given-names>
            </name>
            <name>
              <surname>Jones</surname>
              <given-names>O.P.</given-names>
            </name>
            <name>
              <surname>Mars</surname>
              <given-names>R.B.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Behrens</surname>
              <given-names>T.</given-names>
            </name>
            <name>
              <surname>Jbabdi</surname>
              <given-names>S.</given-names>
            </name>
          </person-group>
          <article-title>Task-free MRI predicts individual differences in brain activity during task performance</article-title>
          <source>Science</source>
          <volume>352</volume>
          <issue>6282</issue>
          <year>2016</year>
          <fpage>216</fpage>
          <lpage>220</lpage>
          <pub-id pub-id-type="pmid">27124457</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0063">
        <element-citation publication-type="journal" id="sbref0063">
          <person-group person-group-type="author">
            <name>
              <surname>Van Essen</surname>
              <given-names>D.C.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
            <name>
              <surname>Barch</surname>
              <given-names>D.M.</given-names>
            </name>
            <name>
              <surname>Behrens</surname>
              <given-names>T.E.</given-names>
            </name>
            <name>
              <surname>Yacoub</surname>
              <given-names>E.</given-names>
            </name>
            <name>
              <surname>Ugurbil</surname>
              <given-names>K.</given-names>
            </name>
            <name>
              <surname>Consortium</surname>
              <given-names>W.-M.H.</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>The WU-Minn human connectome project: an overview</article-title>
          <source>Neuroimage</source>
          <volume>80</volume>
          <year>2013</year>
          <fpage>62</fpage>
          <lpage>79</lpage>
          <pub-id pub-id-type="pmid">23684880</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0064">
        <element-citation publication-type="journal" id="sbref0064">
          <person-group person-group-type="author">
            <name>
              <surname>Van Schependom</surname>
              <given-names>J.</given-names>
            </name>
            <name>
              <surname>Vidaurre</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Costers</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Sjøgård</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>D’hooghe</surname>
              <given-names>M.B.</given-names>
            </name>
            <name>
              <surname>D’haeseleer</surname>
              <given-names>M.</given-names>
            </name>
            <name>
              <surname>Wens</surname>
              <given-names>V.</given-names>
            </name>
            <name>
              <surname>De Tiège</surname>
              <given-names>X.</given-names>
            </name>
            <name>
              <surname>Goldman</surname>
              <given-names>S.</given-names>
            </name>
            <name>
              <surname>Woolrich</surname>
              <given-names>M.</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Altered transient brain dynamics in multiple sclerosis: treatment or pathology?</article-title>
          <source>Hum. Brain Mapp.</source>
          <volume>40</volume>
          <issue>16</issue>
          <year>2019</year>
          <fpage>4789</fpage>
          <lpage>4800</lpage>
          <pub-id pub-id-type="pmid">31361073</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0065">
        <element-citation publication-type="journal" id="sbref0065">
          <person-group person-group-type="author">
            <name>
              <surname>Vidaurre</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Abeysuriya</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Becker</surname>
              <given-names>R.</given-names>
            </name>
            <name>
              <surname>Quinn</surname>
              <given-names>A.J.</given-names>
            </name>
            <name>
              <surname>Alfaro-Almagro</surname>
              <given-names>F.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
            <name>
              <surname>Woolrich</surname>
              <given-names>M.W.</given-names>
            </name>
          </person-group>
          <article-title>Discovering dynamic brain networks from big data in rest and task</article-title>
          <source>Neuroimage</source>
          <volume>180</volume>
          <year>2018</year>
          <fpage>646</fpage>
          <lpage>656</lpage>
          <pub-id pub-id-type="pmid">28669905</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0066">
        <element-citation publication-type="journal" id="sbref0066">
          <person-group person-group-type="author">
            <name>
              <surname>Vidaurre</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Bielza</surname>
              <given-names>C.</given-names>
            </name>
            <name>
              <surname>Larranaga</surname>
              <given-names>P.</given-names>
            </name>
          </person-group>
          <article-title>A survey of l1 regression</article-title>
          <source>Int. Stat. Rev.</source>
          <volume>81</volume>
          <issue>3</issue>
          <year>2013</year>
          <fpage>361</fpage>
          <lpage>387</lpage>
        </element-citation>
      </ref>
      <ref id="bib0067">
        <element-citation publication-type="journal" id="sbref0067">
          <person-group person-group-type="author">
            <name>
              <surname>Vidaurre</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Hunt</surname>
              <given-names>L.T.</given-names>
            </name>
            <name>
              <surname>Quinn</surname>
              <given-names>A.J.</given-names>
            </name>
            <name>
              <surname>Hunt</surname>
              <given-names>B.A.</given-names>
            </name>
            <name>
              <surname>Brookes</surname>
              <given-names>M.J.</given-names>
            </name>
            <name>
              <surname>Nobre</surname>
              <given-names>A.C.</given-names>
            </name>
            <name>
              <surname>Woolrich</surname>
              <given-names>M.W.</given-names>
            </name>
          </person-group>
          <article-title>Spontaneous cortical activity transiently organises into frequency specific phase-coupling networks</article-title>
          <source>Nat. Commun.</source>
          <volume>9</volume>
          <issue>1</issue>
          <year>2018</year>
          <fpage>1</fpage>
          <lpage>13</lpage>
          <pub-id pub-id-type="pmid">29317637</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0068">
        <element-citation publication-type="journal" id="sbref0068">
          <person-group person-group-type="author">
            <name>
              <surname>Vidaurre</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Llera</surname>
              <given-names>A.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
            <name>
              <surname>Woolrich</surname>
              <given-names>M.W.</given-names>
            </name>
          </person-group>
          <article-title>Behavioural relevance of spontaneous, transient brain network interactions in FMRI</article-title>
          <source>Neuroimage</source>
          <volume>229</volume>
          <year>2021</year>
          <fpage>117713</fpage>
          <pub-id pub-id-type="pmid">33421594</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0069">
        <element-citation publication-type="journal" id="sbref0069">
          <person-group person-group-type="author">
            <name>
              <surname>Vidaurre</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Smith</surname>
              <given-names>S.M.</given-names>
            </name>
            <name>
              <surname>Woolrich</surname>
              <given-names>M.W.</given-names>
            </name>
          </person-group>
          <article-title>Brain network dynamics are hierarchically organized in time</article-title>
          <source>Proc. Natl. Acad. Sci.</source>
          <volume>114</volume>
          <issue>48</issue>
          <year>2017</year>
          <fpage>12827</fpage>
          <lpage>12832</lpage>
          <pub-id pub-id-type="pmid">29087305</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0070">
        <element-citation publication-type="journal" id="sbref0070">
          <person-group person-group-type="author">
            <name>
              <surname>Zhi</surname>
              <given-names>D.</given-names>
            </name>
            <name>
              <surname>Calhoun</surname>
              <given-names>V.D.</given-names>
            </name>
            <name>
              <surname>Lv</surname>
              <given-names>L.</given-names>
            </name>
            <name>
              <surname>Ma</surname>
              <given-names>X.</given-names>
            </name>
            <name>
              <surname>Ke</surname>
              <given-names>Q.</given-names>
            </name>
            <name>
              <surname>Fu</surname>
              <given-names>Z.</given-names>
            </name>
            <name>
              <surname>Du</surname>
              <given-names>Y.</given-names>
            </name>
            <name>
              <surname>Yang</surname>
              <given-names>Y.</given-names>
            </name>
            <name>
              <surname>Yang</surname>
              <given-names>X.</given-names>
            </name>
            <name>
              <surname>Pan</surname>
              <given-names>M.</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Aberrant dynamic functional network connectivity and graph properties in major depressive disorder</article-title>
          <source>Front. Psychiatry</source>
          <volume>9</volume>
          <year>2018</year>
          <fpage>339</fpage>
          <pub-id pub-id-type="pmid">30108526</pub-id>
        </element-citation>
      </ref>
      <ref id="bib0071">
        <element-citation publication-type="journal" id="sbref0071">
          <person-group person-group-type="author">
            <name>
              <surname>Zou</surname>
              <given-names>H.</given-names>
            </name>
            <name>
              <surname>Hastie</surname>
              <given-names>T.</given-names>
            </name>
          </person-group>
          <article-title>Regularization and variable selection via the elastic net</article-title>
          <source>J. R. Stat. Soc. Ser. B</source>
          <volume>67</volume>
          <issue>2</issue>
          <year>2005</year>
          <fpage>301</fpage>
          <lpage>320</lpage>
        </element-citation>
      </ref>
    </ref-list>
    <sec id="sec0023">
      <label>Appendix A</label>
      <title>Dynamic structural equation modelling (SEM) perspective</title>
      <p id="p0089">We can gain insight into the multi-dynamic model being proposed, by considering a dynamic version of structural equation modelling (SEM) <xref rid="bib0052" ref-type="bibr">Penny et al. (2004)</xref>:<disp-formula id="eq0017"><label>(17)</label><mml:math id="M276" altimg="si74.svg"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:mi>H</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula> where <inline-formula><mml:math id="M277" altimg="si75.svg"><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is an N*N dimensional matrix containing the connectivity information, where <inline-formula><mml:math id="M278" altimg="si76.svg"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes a connection from region j to region i and <inline-formula><mml:math id="M279" altimg="si77.svg"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> for all regions (in SEM, <inline-formula><mml:math id="M280" altimg="si75.svg"><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is referred to as the path coefficient matrix, M). <inline-formula><mml:math id="M281" altimg="si78.svg"><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is an Qx1 vector of Q structured, external inputs that are independent such that <inline-formula><mml:math id="M282" altimg="si79.svg"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>t</mml:mi><mml:mo>⊺</mml:mo></mml:msubsup><mml:mo linebreak="goodbreak">=</mml:mo><mml:mi>I</mml:mi></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="M283" altimg="si80.svg"><mml:mi>H</mml:mi></mml:math></inline-formula> is an NxQ dimensional mixing matrix describing how much of each external input is contributing to each region. Finally, <inline-formula><mml:math id="M284" altimg="si81.svg"><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is a random variable modelling the noise in <inline-formula><mml:math id="M285" altimg="si6.svg"><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> using a Gaussian distribution with zero mean and an NxN diagonal covariance matrix, i.e., <inline-formula><mml:math id="M286" altimg="si82.svg"><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. Note that the idea is that <inline-formula><mml:math id="M287" altimg="si78.svg"><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> would be identifiable through its non-Gaussian, spatio-temporal structure, which is what makes it distinct to <inline-formula><mml:math id="M288" altimg="si81.svg"><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>. Note that typically in SEM, only the noise, <inline-formula><mml:math id="M289" altimg="si81.svg"><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, is modelled and an external input, <inline-formula><mml:math id="M290" altimg="si78.svg"><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, is not (i.e. <inline-formula><mml:math id="M291" altimg="si83.svg"><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>). However, other variants of SEM have previously considered modelling structured, external inputs <xref rid="bib0057" ref-type="bibr">Shimizu et al. (2006)</xref>.</p>
      <p id="p0090">It is straightforward<xref rid="fn0006" ref-type="fn">6</xref> to then show that <inline-formula><mml:math id="M292" altimg="si6.svg"><mml:msub><mml:mi>Y</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> is Gaussian distributed, with a time-varying mean and covariance with the same form as in <xref rid="eq0003" ref-type="disp-formula">Eqs. (3)</xref>, <xref rid="eq0004" ref-type="disp-formula">(4)</xref>, where<disp-formula id="eq0018"><label>(18)</label><mml:math id="M293" altimg="si84.svg"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>H</mml:mi><mml:mspace width="0.28em"/><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></disp-formula><disp-formula id="eq0019"><label>(19)</label><mml:math id="M294" altimg="si85.svg"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo linebreak="goodbreak">=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.16em"/><mml:mrow><mml:mo>(</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>Σ</mml:mi></mml:mstyle><mml:mo linebreak="badbreak">+</mml:mo><mml:mi>H</mml:mi><mml:msup><mml:mi>H</mml:mi><mml:mo>⊺</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.16em"/><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>⊺</mml:mo></mml:msup></mml:mrow></mml:math></disp-formula></p>
      <p id="p0091">In other words, if we assume that in the dynamic SEM the external inputs, <inline-formula><mml:math id="M295" altimg="si78.svg"><mml:msub><mml:mi>μ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, and the dynamic connectivity, <inline-formula><mml:math id="M296" altimg="si75.svg"><mml:msub><mml:mi>A</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula>, fluctuate distinctly from each other; then correspondingly <inline-formula><mml:math id="M297" altimg="si1.svg"><mml:msub><mml:mi>m</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M298" altimg="si8.svg"><mml:msub><mml:mi>F</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></inline-formula> can also fluctuate distinctly from each other (see <xref rid="eq0018" ref-type="disp-formula">Eq. (18)</xref>, <xref rid="eq0019" ref-type="disp-formula">(19)</xref>) also need to fluctuate distinctly from each other. This is what we are assuming in the <italic>multi-dynamic</italic> approach.</p>
    </sec>
    <sec id="sec0026" sec-type="supplementary-material">
      <title>Supplementary material</title>
      <p id="p0092">Supplementary material associated with this article can be found, in the online version, at doi:<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.media.2022.102366" id="intrrf0001">10.1016/j.media.2022.102366</ext-link>.</p>
    </sec>
    <sec id="sec0024" sec-type="supplementary-material">
      <label>Appendix B</label>
      <title>Supplementary materials</title>
      <p id="p0093">
<supplementary-material content-type="local-data" id="ecom0001"><caption><title>Supplementary Data S1</title><p>Supplementary Raw Research Data. This is open data under the CC BY license <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" id="intrrf0002">http://creativecommons.org/licenses/by/4.0/</ext-link></p></caption><media xlink:href="mmc1.pdf"><alt-text>Supplementary Data S1</alt-text></media></supplementary-material>
</p>
      <p id="p0094">
<supplementary-material content-type="local-data" id="ecom0002"><caption><title>Supplementary Data S2</title><p>Supplementary Raw Research Data. This is open data under the CC BY license <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" id="intrrf0003">http://creativecommons.org/licenses/by/4.0/</ext-link></p></caption><media xlink:href="mmc2.mp4"><alt-text>Supplementary Data S2</alt-text></media></supplementary-material>
</p>
    </sec>
    <ack id="ack0001">
      <title>Acknowledgements</title>
      <p id="p0084">Computation used the Oxford Biomedical Research Computing (BMRC) facility, a joint development between the Wellcome Centre for Human Genetics and the Big Data Institute supported by Health Data Research UK and the NIHR Oxford Biomedical Research Centre.</p>
      <p id="p0085">We are extremely grateful to all UK Biobank (Data Access Application 8107) and Human Connectome Project participants who generously donated their time to make this resource possible. UK Biobank (including the imaging enhancement) has been generously supported by the UK Medical Research Council and the Wellcome Trust. Human Connectome Project, WU-Minn Consortium (Principal Investigators: David Van Essen and Kamil Ugurbil; 1U54MH091657) funded by the 16 NIH Institutes and Centers that support the NIH Blueprint for Neuroscience Research; and by the McDonnell Center for Systems Neuroscience at Washington University.</p>
      <p id="p0086">We additionally thanks Eugene Duff for providing the data access to the cognitive task fMRI data and Samuel Harrison for pre-processing the task data. Furthermore, we are thankful to Ryan Timms and Evan Roberts for the helpful discussions.</p>
      <p id="p0087">MWW’s research is supported by the NIHR Oxford Health Biomedical Research Centre, the Wellcome Trust (106183/Z/14/Z, 215573/Z/19/Z), the New Therapeutics in Alzheimer’s Diseases (NTAD) study supported by UK MRC and the Dementia Platform UK (RG94383/RG89702) and the EU-project euSNN (MSCA-ITN H2020-860563). The Wellcome Centre for Integrative Neuroimaging is supported by core funding from the Wellcome Trust (203139/Z/16/Z).</p>
      <p id="p0088">UP’s research is funded by an MRC Mental Health Data Pathfinder award (PI Clare Mackay) MC/PC/17215. SMS’s research is supported by the XMI2: Wellcome Trust Collaborative Award 215573/Z/19/Z. DV’s research is supported by Novo Nordisk Foundation Emerging Investigator Fellowship (NNF19OC-0054895) and ERC Starting Grant (ERC-StG-2019-850404).</p>
    </ack>
    <fn-group>
      <fn id="fn0001">
        <label>1</label>
        <p id="notep0001">The reason MAGE models the variances to be independent of the correlation (i.e., <inline-formula><mml:math id="M299" altimg="si19.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> free to be not equal to <inline-formula><mml:math id="M300" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) is to allow maximum temporal independence to the correlation. We will expand onto this in <xref rid="sec0022" ref-type="sec">Section 4</xref> but allowing <inline-formula><mml:math id="M301" altimg="si19.svg"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> = <inline-formula><mml:math id="M302" altimg="si16.svg"><mml:msub><mml:mi>β</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> resulted in weaker state-specific FCs dynamics, and hence was not a preferable modelling choice.</p>
      </fn>
      <fn id="fn0002">
        <label>2</label>
        <p id="notep0002">For this particular simulation, the number of channels in the data is 20, the number of modelled states (P=Q=R) is 12, and multi-dynamics state time courses for the means and the correlations are simulated using two different hidden semi-Markov model chains.</p>
      </fn>
      <fn id="fn0003">
        <label>3</label>
        <p id="notep0003">For HCP data, we use the minimally-preprocessed released data, in gray ordinates (cortical surface vertices and subcortical voxels). For UKB data, we used the preprocessed released data in standard volumetric space.</p>
      </fn>
      <fn id="fn0004">
        <label>4</label>
        <p id="notep0004">To apply group-ICA, we first generated the group-PCA (Principal Component Analysis) output using MIGP (MELODICs Incremental group-PCA) (<xref rid="bib0060" ref-type="bibr">Smith et al., 2014</xref>) using data from all subjects. This comprises the top few thousands (1000–5000) weighted spatial eigenvectors from a group-averaged PCA, which is a very close approximation to the original data (fully concatenating all subjects’ time-series. Lastly, group-ICA is run on the output of group-PCA.</p>
      </fn>
      <fn id="fn0005">
        <label>5</label>
        <p id="notep0005">For other such examples, see <xref rid="bib0068" ref-type="bibr">Vidaurre et al. (2021)</xref> for modelling only the covariance and <xref rid="bib0008" ref-type="bibr">Charquero-Ballester et al. (2020)</xref> for modelling only the mean activity.</p>
      </fn>
      <fn id="fn0006">
        <label>6</label>
        <p id="notep0006">Such investigations to establish the relationship between SEM and FC has been previously conducted in detailed by <xref rid="bib0046" ref-type="bibr">Marrelec and Benali (2009)</xref>.</p>
      </fn>
    </fn-group>
  </back>
</article>
